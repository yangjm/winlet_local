function ElmRect(e){if(null==e)return null;var n=e.offset();this.left=n.left,this.top=n.top,this.width=e[0].offsetWidth,this.height=e[0].offsetHeight,this.right=this.left+this.width,this.bottom=this.top+this.height}String.prototype.endsWith=function(e){return-1!==this.indexOf(e,this.length-e.length)},function(e,n){"use strict";var t,i;e.uaMatch=function(e){e=e.toLowerCase();var n=/(chrome)[ \/]([\w.]+)/.exec(e)||/(webkit)[ \/]([\w.]+)/.exec(e)||/(opera)(?:.*version|)[ \/]([\w.]+)/.exec(e)||/(msie) ([\w.]+)/.exec(e)||e.indexOf("compatible")<0&&/(mozilla)(?:.*? rv:([\w.]+)|)/.exec(e)||[],t=/(ipad)/.exec(e)||/(iphone)/.exec(e)||/(android)/.exec(e)||[];return{browser:n[1]||"",version:n[2]||"0",platform:t[0]||""}},t=e.uaMatch(n.navigator.userAgent),i={},t.browser&&(i[t.browser]=!0,i.version=t.version),t.platform&&(i[t.platform]=!0),i.chrome?i.webkit=!0:i.webkit&&(i.safari=!0),e.browser=i}(jQuery,window),function(e,n,t){function i(e){return e=e||location.href,"#"+e.replace(/^[^#]*#?(.*)$/,"$1")}var r,a="hashchange",o=document,l=e.event.special,s=o.documentMode,c="on"+a in n&&(s===t||s>7);e.fn[a]=function(e){return e?this.bind(a,e):this.trigger(a)},e.fn[a].delay=50,l[a]=e.extend(l[a],{setup:function(){return c?!1:(e(r.start),void 0)},teardown:function(){return c?!1:(e(r.stop),void 0)}}),r=function(){function r(){var t=i(),o=d(g);t!==g?(u(g=t,o),e(n).trigger(a)):o!==g&&(location.href=location.href.replace(/#.*/,"")+o),l=setTimeout(r,e.fn[a].delay)}var l,s={},g=i(),p=function(e){return e},u=p,d=p;return s.start=function(){l||r()},s.stop=function(){l&&clearTimeout(l),l=t},e.browser.msie&&!c&&function(){var n,t;s.start=function(){n||(t=e.fn[a].src,t=t&&t+i(),n=e('<iframe tabindex="-1" title="empty"/>').hide().one("load",function(){t||u(i()),r()}).attr("src",t||"javascript:0").insertAfter("body")[0].contentWindow,o.onpropertychange=function(){try{"title"===event.propertyName&&(n.document.title=o.title)}catch(e){}})},s.stop=p,d=function(){return i(n.location.href)},u=function(t,i){var r=n.document,l=e.fn[a].domain;t!==i&&(r.title=o.title,r.open(),l&&r.write('<script>document.domain="'+l+'"</script>'),r.close(),n.location.hash=t)}}(),s}()}(jQuery,this),function(e){function n(e){return"string"==typeof e}function t(e){var n=A.call(arguments,1);return function(){return e.apply(this,n.concat(A.call(arguments)))}}function i(e){return e.replace(w,"$2")}function r(e){return e.replace(/(?:^[^?#]*\?([^#]*).*$)?.*/,"$1")}function a(t,i,r,a,o){var l,g,u,d,f;return a!==s?(u=r.match(t?w:/^([^#?]*)\??([^#]*)(#?.*)/),f=u[3]||"",2===o&&n(a)?g=a.replace(t?m:H,""):(d=p(u[2]),a=n(a)?p[t?R:b](a):a,g=2===o?a:1===o?e.extend({},a,d):e.extend({},d,a),g=c(g),t&&(g=g.replace(S,y))),l=u[1]+(t?E:g||!u[1]?"?":"")+g+f):l=i(r!==s?r:location.href),l}function o(e,t,i){return t===s||"boolean"==typeof t?(i=t,t=$[e?R:b]()):t=n(t)?t.replace(e?m:H,""):t,p(t,i)}function l(t,i,r,a){return n(r)||"object"==typeof r||(a=r,r=i,i=s),this.each(function(){var n=e(this),o=i||h()[(this.nodeName||"").toLowerCase()]||"",l=o&&n.attr(o)||"";n.attr(o,$[t](l,r,a))})}var s,c,g,p,u,d,f,h,m,w,S,v,E,A=Array.prototype.slice,y=decodeURIComponent,$=e.param,J=e.bbq=e.bbq||{},_=e.event.special,x="hashchange",b="querystring",R="fragment",W="elemUrlAttr",C="href",j="src",H=/^.*\?|#.*$/g,I={};$[b]=t(a,0,r),$[R]=g=t(a,1,i),$.sorted=c=function(n,t){var i=[],r={};return e.each($(n,t).split("&"),function(e,n){var t=n.replace(/(?:%5B|=).*$/,""),a=r[t];a||(a=r[t]=[],i.push(t)),a.push(n)}),e.map(i.sort(),function(e){return r[e]}).join("&")},g.noEscape=function(n){n=n||"";var t=e.map(n.split(""),encodeURIComponent);S=new RegExp(t.join("|"),"g")},g.noEscape(",/"),g.ajaxCrawlable=function(e){return e!==s&&(e?(m=/^.*(?:#!|#)/,w=/^([^#]*)(?:#!|#)?(.*)$/,E="#!"):(m=/^.*#/,w=/^([^#]*)#?(.*)$/,E="#"),v=!!e),v},g.ajaxCrawlable(0),e.deparam=p=function(n,t){var i={},r={"true":!0,"false":!1,"null":null};return e.each(n.replace(/\+/g," ").split("&"),function(n,a){var o,l=a.split("="),c=y(l[0]),g=i,p=0,u=c.split("]["),d=u.length-1;if(/\[/.test(u[0])&&/\]$/.test(u[d])?(u[d]=u[d].replace(/\]$/,""),u=u.shift().split("[").concat(u),d=u.length-1):d=0,2===l.length)if(o=y(l[1]),t&&(o=o&&!isNaN(o)?+o:"undefined"===o?s:r[o]!==s?r[o]:o),d)for(;d>=p;p++)c=""===u[p]?g.length:u[p],g=g[c]=d>p?g[c]||(u[p+1]&&isNaN(u[p+1])?{}:[]):o;else e.isArray(i[c])?i[c].push(o):i[c]=i[c]!==s?[i[c],o]:o;else c&&(i[c]=t?s:"")}),i},p[b]=t(o,0),p[R]=u=t(o,1),e[W]||(e[W]=function(n){return e.extend(I,n)})({a:C,base:C,iframe:j,img:j,input:j,form:"action",link:C,script:j}),h=e[W],e.fn[b]=t(l,b),e.fn[R]=t(l,R),J.pushState=d=function(e,t){n(e)&&/^#/.test(e)&&t===s&&(t=2);var i=e!==s,r=g(location.href,i?e:{},i?t:2);location.href=r},J.getState=f=function(e,n){return e===s||"boolean"==typeof e?u(e):u(n)[e]},J.removeState=function(n){var t={};n!==s&&(t=f(),e.each(e.isArray(n)?n:arguments,function(e,n){delete t[n]})),d(t,2)},_[x]=e.extend(_[x],{add:function(n){function t(e){var n=e[R]=g();e.getState=function(e,t){return e===s||"boolean"==typeof e?p(n,e):p(n,t)[e]},i.apply(this,arguments)}var i;return e.isFunction(n)?(i=n,t):(i=n.handler,n.handler=t,void 0)}})}(jQuery,this),jQuery.fn.winform=function(){var e=$.extend({},arguments[0]);return this.each(function(){if(!this.winsubmit){if(this.winsubmit=function(){if(null!=this.onsubmit)try{if(!this.onsubmit())return!1}catch(n){return alert(n),!1}if("multipart/form-data"==$(this).attr("enctype"))return this.action=this.action+"&"+AeJSEngine.mergeParam(e.wid,{_pg:window.location.pathname,_purl:window.location.href}),!0;if("POST"!=$(this).attr("method").toUpperCase()){var t=$.deparam($(this).serialize());return $(this).find(":checkbox").each(function(){void 0==t[this.name]&&(t[this.name]="")}),AeJSEngine.setHash(e.wid,t),AeJSEngine.loadContent(e.wid),AeJSEngine.updateWindows(e.wid,e.update),!1}try{"yes"!=e.hideloading&&AeJSEngine.showLoading("#ap_win_"+e.wid,e.dialog)}catch(n){}for(var i=new Array,r=$(this).find(":input").find(":disabled"),a=0;a<r.length;a++)""!=r[a].name&&(i[i.length]=r[a].name);var o=new Array;r=$(this).find(":input");for(var a=0;a<r.length;a++)""!=r[a].name&&(o[o.length]=r[a].name);return $.ajax({type:"POST",url:this.action,data:AeJSEngine.mergeParam(e.wid,$.deparam($(this).serialize()),{_x:"y",_v:e.validate,_ff:o,_fd:i,_pg:window.location.pathname,_purl:window.location.href}),success:AeJSEngine.getActionResponseHandler(e.wid,this,this.aftersubmit),error:AeJSEngine.getErrorHandler(e.wid),dataType:"text"}),!1},this.ajaxValidate=function(n,t,i){void 0==t&&(t=n.name),AeJSEngine.form.validating(n);var r=i;"checkbox"==n.type?n.checked&&(r=n.value):r=n.value;var a={_vf:t,_vv:r,_vid:n.id};a[t]=r,$.ajax({type:"POST",url:this.action,data:AeJSEngine.mergeParam(e.wid,a,{_x:"y",_pg:window.location.pathname,_purl:window.location.href}),success:AeJSEngine.form.getValidateResponseHandler(n.form,t,n),dataType:"json"})},$(this).submit(this.winsubmit),e.focus){var n=$(this).find('input[name="'+e.focus+'"]');n.select(),n.focus()}this.updateValidate=function(){if("yes"==e.validate){var n=this,t=$(n);t.find(":input").each(function(){if(null!=this.name&&""!=this.name){var e=$(this);if("no"!=e.data("validate")){if("INPUT"==e.prop("tagName")){var n=$(this).prop("type");if("text"!=n&&"email"!=n&&"checkbox"!=n&&"radio"!=n&&"password"!=n)return}void 0!=e.attr("tips")&&e.off("blur").off("fucos").focus(function(){AeJSEngine.form.showTip(this)}).blur(function(){AeJSEngine.form.hideTip(this)}),e.off("change").change(function(){this.form.ajaxValidate(this)})}}})}},this.updateValidate()}})};var AeJSEngine={ImgBg:new Image(1,1),ImgLoading:new Image(1,1),ImgValidating:new Image(1,1),topSpace:0,bottomSpace:0,leftSpace:0,rightSpace:0,widCounter:0,isStatic:!1,isApme:!1,detectHashChange:!0,reEscape:/(:|\.|\[|\])/g,reScriptAll:new RegExp("<script.*?>(?:\n|\r|.)*?</script>","img"),reScriptOne:new RegExp("<script(.*?)>((?:\n|\r|.)*?)</script>","im"),reScriptLanguage:new RegExp('.*?language.*?=.*?"(.*?)"',"im"),reScriptSrc:new RegExp('.*?src.*?=.*?"(.*?)"',"im"),reScriptType:new RegExp('.*?type.*?=.*?"(.*?)"',"im"),reScriptCharset:new RegExp('.*?charset.*?=.*?"(.*?)"',"im"),reCSSAll:new RegExp('<link.*?type="text/css".*?>',"img"),reCSSHref:new RegExp('.*?href="(.*?)"',"im"),reWinWid:new RegExp("win\\$\\.wid\\s*\\(.*\\)","img"),reWinPost:new RegExp("win\\$\\.post\\s*\\(","img"),reWinAjax:new RegExp("win\\$\\.ajax\\s*\\(","img"),reWinGet:new RegExp("win\\$\\.get\\s*\\(","img"),reWinToggle:new RegExp("win\\$\\.toggle\\s*\\(","img"),reWinUrl:new RegExp("win\\$\\.url\\s*\\(","img"),reWinSubmit:new RegExp("win\\$\\.submit\\s*\\(","img"),reWinAfterSubmit:new RegExp("win\\$\\.aftersubmit\\s*\\(","img"),reWinlet:new RegExp("^((\\w+/.+)/(\\w+))(\\?([^\\s]+))?(\\s+(.*?))?$"),reWinletParam:new RegExp("(\\w+)\\:(\\w+)"),reDialogSetting:new RegExp('<div id="ap_dialog">(.*?)</div>',"img"),hashGroupsByUri:{},hashGroupByRootWindow:{},form:{createResultHolder:function(e){return null!=e.m_result?e.m_result:"no"==$(e).data("validate")?null:(e.m_result=$(e.form).find("span.validate_result[data-input='"+e.name.replace("[","\\[").replace("]","\\]").replace(".","\\.")+"']"),0==e.m_result.length&&(e.m_result=$('<span class="validate_result"></span>'),$(e).after(e.m_result)),void 0)},getInputResult:function(e){return null==e.m_result&&AeJSEngine.form.createResultHolder(e),e.m_result},validateClearAll:function(e){$(e).find("span.validate_result").each(function(){$(this).html("")})},validateClear:function(e){var n=AeJSEngine.form.getInputResult(e);null!=n&&n.html("")},validating:function(){},validateSuccess:function(e){var n=AeJSEngine.form.getInputResult(e);null!=n&&n.html('<span class="win_valpassed">&nbsp;</span>')},validateError:function(e,n){var t=AeJSEngine.form.getInputResult(e);if(null!=t){var i=t.find("div.win_valfailed");0==i.length&&(t.html("<div class='win_valfailed'></div>"),i=t.find("div.win_valfailed")),i.text(n)}},applyChanges:function(json,form,input){var changes=null;try{changes=eval(json)}catch(e){}if(null!=changes)for(var i=0;i<changes.length;i++){var inp=$(form).find(":input[name='"+changes[i].input+"']");if(0==inp.length&&(inp=$("#"+changes[i].input)),0!=inp.length)if(inp=inp[0],"v"==changes[i].type)""!=changes[i].message&&(AeJSEngine.form.validateClear(inp),AeJSEngine.form.validateError(inp,changes[i].message));else if("u"==changes[i].type)"radio"==inp.type?$(form).children(":input[name='"+changes[i].input+"'][value='"+changes[i].value+"']").attr("checked","checked"):"checkbox"==inp.type?inp.checked=changes[i].value:(input==inp&&AeJSEngine.form.validateSuccess(input),$(inp).val(changes[i].value));else if("d"==changes[i].type)inp.disabled=!0,AeJSEngine.form.validateClear(inp);else if("e"==changes[i].type)inp.disabled=!1;else if("l"==changes[i].type&&(inp.type="select")){$(inp).empty();for(var j=0;j<changes[i].list.length;j++)$(inp).append('<option value="'+changes[i].list[j].id+'">'+changes[i].list[j].name+"</option>")}}},getValidateResponseHandler:function(e,n,t){return function(n){if(AeJSEngine.form.validateClear(t),AeJSEngine.form.applyChanges(n,e,t),void 0!=e.onerror&&void 0!=t)try{e.onerror(t)}catch(i){}}},showTip:function(e){var n=AeJSEngine.form.getInputResult(e);null!=n&&""==n.html()&&n.html('<div class="win_tips">'+$(this).attr("tips")+"</div>")},hideTip:function(e){var n=AeJSEngine.form.getInputResult(e);null!=n&&n.find("div.win_tips").length>0&&n.html("")}},_utf8_decode:function(e){if(null==e)return null;e=unescape(e);for(var n="",t=0,i=c1=c2=0;t<e.length;)i=e.charCodeAt(t),128>i?(n+=String.fromCharCode(i),t++):i>191&&224>i?(c2=e.charCodeAt(t+1),n+=String.fromCharCode((31&i)<<6|63&c2),t+=2):(c2=e.charCodeAt(t+1),c3=e.charCodeAt(t+2),n+=String.fromCharCode((15&i)<<12|(63&c2)<<6|63&c3),t+=3);return n},getRootWinId:function(e){return e=e.toString(),e.substr(0,1+parseInt(e.substr(0,1)))},isRootWinId:function(e){return AeJSEngine.getRootWinId(e)==e},getWinSettings:function(e){return $("#ap_win_"+AeJSEngine.getRootWinId(e))[0].settings},getHash:function(e){var n=AeJSEngine.hashGroupByRootWindow[AeJSEngine.getRootWinId(e)].idx;try{return $.param($.deparam(window.location.toString().split("#")[1])[n],!0)}catch(t){}return""},setHash:function(e,n,t){var i=AeJSEngine.hashGroupByRootWindow[AeJSEngine.getRootWinId(e)].idx,r=null;try{r=$.deparam(window.location.toString().split("#")[1])}catch(a){}if(r instanceof Object||(r={}),void 0==r[i]&&(r[i]={}),t)for(property in n)$.isArray(n[property])?$.isArray(r[i][property])?$.each(n[property],function(e,n){n=""+n;var t=$.inArray(n,r[i][property]);0>t?r[i][property].push(n):r[i][property].splice(t,1)}):r[i][property]=n[property]:r[i][property]==n[property]?delete r[i][property]:r[i][property]=n[property];else $.extend(r[i],n);for(property in r[i])""==r[i][property]&&delete r[i][property];AeJSEngine.detectHashChange=!1;var o=$.param(r);window.location.hash=""==o?"_":o},mergeParam:function(e){var n={},t=AeJSEngine.getWinSettings(e);null!=t.params&&$.extend(n,t.params);var i=window.location.href.indexOf("?");i>0&&$.extend(n,$.deparam(window.location.href.substr(i+1)));try{$.extend(n,$.deparam(AeJSEngine.getHash(e)))}catch(r){}for(var a=1;a<arguments.length;a++)null!=arguments[a]&&$.extend(n,arguments[a]);return $.param(n,!0)},ensureVisible:function(e){var n=$(e);if(null!=n&&0!=n.length)try{var t=document.documentElement,i=(window.pageXOffset||t.scrollLeft)-(t.clientLeft||0),r=(window.pageYOffset||t.scrollTop)-(t.clientTop||0),a=new ElmRect(n);a.top-=AeJSEngine.topSpace,a.bottom+=AeJSEngine.bottomSpace,a.left-=AeJSEngine.leftSpace,a.right+=AeJSEngine.rightSpace;var o=0;i+t.clientWidth<a.right&&(o=a.right-i-t.clientWidth),i+o>a.left&&(o=a.left-i);var l=0;r+t.clientHeight<a.bottom&&(l=a.bottom-r-t.clientHeight),r+l>a.top&&(l=a.top-r),(0!=o||0!=l)&&window.scrollBy(o,l)}catch(s){}},clearLoading:function(e){try{$(e+"_loading").remove()}catch(n){}},showLoading:function(e,n){try{AeJSEngine.clearLoading(e);var t=new ElmRect($(e));try{null!=n&&(t=new ElmRect(n))}catch(i){}var r;r="6.0"==jQuery.browser.version?"<div id='"+e.substr(1)+"_loading' style='z-index:100000;position:absolute;background-color:#999999;filter:alpha(opacity=30);-moz-opacity:0.3;left:"+t.left+"px;top:"+t.top+"px;width:"+t.width+"px;height:"+t.height+"px'><table width='100%' height='100%' border='0'><tr height='100%'><td align='center' valign='middle'><img src='"+AeJSEngine.ImgLoading.src+"'/></td></tr></table></div>":"<div id='"+e.substr(1)+"_loading' style='z-index:100000;position:absolute;background:url("+AeJSEngine.ImgBg.src+");left:"+t.left+"px;top:"+t.top+"px;width:"+t.width+"px;height:"+t.height+"px'><table width='100%' height='100%' border='0'><tr height='100%'><td align='center' valign='middle'><img src='"+AeJSEngine.ImgLoading.src+"'/></td></tr></table></div>",$("body").append(r)}catch(i){}},procStyle:function(e){var n,t,i,r=e.match(AeJSEngine.reCSSAll)||[],a=$.map(r,function(e){return(e.match(AeJSEngine.reCSSHref)||["",""])[1]}),o=document.getElementsByTagName("head")[0],l=o.getElementsByTagName("link");for(n=0;n<a.length;n++)if(""!=a[n]){for(t=0;t<l.length&&l[t].href!=a[n];t++);t<l.length||(i=document.createElement("link"),i.type="text/css",i.rel="stylesheet",i.href=a[n],i.media="screen",o.appendChild(i))}return e.replace(AeJSEngine.reCSSAll,"")},procWinFunc:function(e,n){return e.replace(AeJSEngine.reWinPost,"win$._post("+n+", ").replace(AeJSEngine.reWinWid,"win$._wid("+n+")").replace(AeJSEngine.reWinAjax,"win$._ajax("+n+", ").replace(AeJSEngine.reWinGet,"win$._get("+n+", ").replace(AeJSEngine.reWinToggle,"win$._toggle("+n+", ").replace(AeJSEngine.reWinUrl,"win$._url("+n+", ").replace(AeJSEngine.reWinSubmit,"win$._submit("+n+", ").replace(AeJSEngine.reWinAfterSubmit,"win$._aftersubmit("+n+", ")},procScript:function(wid,cont){var scripts=cont.match(AeJSEngine.reScriptAll)||[],scriptContent=$.map(scripts,function(e){return(e.match(AeJSEngine.reScriptOne)||["","",""])[2]}),scriptDef=$.map(scripts,function(e){return(e.match(AeJSEngine.reScriptOne)||["","",""])[1]}),scriptLanguage=$.map(scriptDef,function(e){return(e.match(AeJSEngine.reScriptLanguage)||["",""])[1]}),scriptSrc=$.map(scriptDef,function(e){return(e.match(AeJSEngine.reScriptSrc)||["",""])[1]}),scriptType=$.map(scriptDef,function(e){return(e.match(AeJSEngine.reScriptType)||["",""])[1]}),scriptCharset=$.map(scriptDef,function(e){return(e.match(AeJSEngine.reScriptCharset)||["",""])[1]}),elmHead=document.getElementsByTagName("head")[0],elmScripts=elmHead.getElementsByTagName("script"),i,j,ret=[];for(i=0;i<scripts.length;i++)if(""!=scriptSrc[i]){for(j=0;j<elmScripts.length&&elmScripts[j].src!=scriptSrc[i];j++);if(!(j<elmScripts.length)){var dtd=$.Deferred(),newScript=document.createElement("script");newScript.type=""!=scriptType[i]?scriptType[i]:""!=scriptLanguage[i]?"text/"+scriptLanguage[i]:"text/javascript",""!=scriptCharset[i]&&(newScript.charset=scriptCharset[i]),$(newScript).load(function(){dtd.resolve()}).on("readystatechange",function(){"loaded"==newScript.readyState&&dtd.resolve()}),elmHead.appendChild(newScript),newScript.src=scriptSrc[i],ret[ret.length]=dtd.promise()}}$.when.apply($,ret).done(function(){for(i=0;i<scriptContent.length;i++)try{eval(AeJSEngine.procWinFunc(scriptContent[i],wid))}catch(e){alert(e.message),alert(scriptContent[i])}})},invokeAfterLoad:function(){if(AeJSEngine.afterLoad)try{AeJSEngine.afterLoad()}catch(e){}},enableForm:function(e){e.find("form[data-winlet-wid]").each(function(){var e=$(this);e.winform({wid:e.attr("data-winlet-wid"),focus:e.attr("data-winlet-focus"),update:e.attr("data-winlet-update"),validate:e.attr("data-winlet-validate"),hideloading:e.attr("data-winlet-hideloading")})})},getWindowResponseHandler:function(e,n){return function(t,i,r){var a=r.getResponseHeader("X-Winlet-Redirect");if(null!=a&&""!=a)return window.location.href=a,void 0;var o="#ap_win_"+e,l=$(o),s=!1;if(AeJSEngine.isRootWinId(e)&&"yes"==AeJSEngine.getWinSettings(e).dialog){s=!0;var c=AeJSEngine._utf8_decode(r.getResponseHeader("X-Winlet-Title"));AeJSEngine.openDialog(!1,e,t,c)}else l.html(AeJSEngine.procStyle(AeJSEngine.procWinFunc(t.replace(AeJSEngine.reScriptAll,""),e))),$(function(){AeJSEngine.enableForm(l)}),AeJSEngine.procScript(e,t);AeJSEngine.invokeAfterLoad(),AeJSEngine.clearLoading(o),l.trigger("AeWindowLoaded",e),!s&&n&&AeJSEngine.ensureVisible(o)}},loadContent:function(e,n,t){var i="#ap_win_"+e;0!=$(i).length&&(AeJSEngine.showLoading(i),$.ajax({type:"POST",url:AeJSEngine.getWinSettings(e).url,data:AeJSEngine.mergeParam(e,{_x:"y",_w:e,_pg:window.location.pathname,_purl:window.location.href,_pr:t?"yes":"no"}),success:AeJSEngine.getWindowResponseHandler(e,n),error:AeJSEngine.getErrorHandler(),dataType:"html"}))},getActionResponseHandler:function(e){for(var n=null,t=null,i=1;i<arguments.length;i++)null!=arguments[i]&&("[object Array]"==Object.prototype.toString.call(arguments[i])?t=arguments[i]:n=arguments[i]);return function(i,r,a){var o=a.getResponseHeader("X-Winlet-Redirect"),l=a.getResponseHeader("X-Winlet-Update"),s=a.getResponseHeader("X-Winlet-Dialog"),c=a.getResponseHeader("X-Winlet-Cache"),g=AeJSEngine._utf8_decode(a.getResponseHeader("X-Winlet-Title"));if(null!=o&&""!=o&&(m.location.href=o),"page"==l)return location.reload(),void 0;var p="#ap_win_"+e;if(AeJSEngine.clearLoading(p),null==n||"yes"==s||0!=i.indexOf("WINLET_FORM_RESP:")){if(null!=t)for(var u=0;u<t.length;u++)try{var d=t[u](i,r,a);if(void 0!=d&&null!=d&&!d)return}catch(f){alert(f)}for("yes"!=c&&AeJSEngine.loadContent(e);null!=l&&""!=l;){var h=l.indexOf(","),m=l;-1!=h?(m=l.substr(0,h),l=l.substr(h+1)):(m=l,l="");var w=!1;0==m.indexOf("!")&&(w=!0,m=m.substring(1)),e!=m&&AeJSEngine.loadContent(m,w)}"yes"==s?AeJSEngine.openDialog(!0,e,i,g):AeJSEngine.closeDialog()}else if(AeJSEngine.form.validateClearAll(n),AeJSEngine.form.applyChanges(i.substr(17),n),void 0!=n.onerror)try{n.onerror(null)}catch(f){}}},updateWindows:function(e,n){if(null!=n&&""!=n){var t,i=n.split(","),r=null;for(t=0;t<i.length;t++)try{var a=i[t],o=!1;0==a.indexOf("!")&&(o=!0,a=a.substring(1));var l=AeJSEngine.hashGroupByRootWindow[AeJSEngine.getRootWinId(e)].views[a];null!=l?AeJSEngine.loadContent(l,o):r=null==r?i[t]:r+", "+i[t]}catch(s){}null!=r&&$.ajax({type:"POST",url:AeJSEngine.getWinSettings(e).url,data:AeJSEngine.mergeParam(e,{_x:"y",_w:e,_u:r,_pg:window.location.pathname,_purl:window.location.href}),success:AeJSEngine.getActionResponseHandler(e),error:AeJSEngine.getErrorHandler(e),dataType:"html"})}},getErrorHandler:function(){return function(){}},isInt:function(e){return void 0!=e&&null!=e&&Number(e)===e&&e%1===0},init:function(e){$("body").append("<div id='winlet_style_temp' style='display:none'><div class='winlet_background'>1</div><div class='winlet_loading'>2</div><div class='winlet_validating'>3</div></div>"),$(function(){AeJSEngine.ImgBg.src=$("#winlet_style_temp .winlet_background").css("background-image").replace(/^url|[\(\)"]/g,""),AeJSEngine.ImgLoading.src=$("#winlet_style_temp .winlet_loading").css("background-image").replace(/^url|[\(\)"]/g,""),AeJSEngine.ImgValidating.src=$("#winlet_style_temp .winlet_validating").css("background-image").replace(/^url|[\(\)"]/g,""),console.log(AeJSEngine.ImgLoading.src),$("#winlet_style_temp").remove()}),e&&(AeJSEngine.isInt(e.left)&&(AeJSEngine.leftSpace=e.left),AeJSEngine.isInt(e.right)&&(AeJSEngine.rightSpace=e.right),AeJSEngine.isInt(e.top)&&(AeJSEngine.topSpace=e.top),AeJSEngine.isInt(e.bottom)&&(AeJSEngine.bottomSpace=e.bottom)),AeJSEngine.isStatic=!0;var n={preload:!0,start:0,maxIdx:0},t=function(e){n.maxIdx=e,e+=n.start;var t=$(this).data("wid");if(null==t){if(n.preload)return;t=e.toString().length.toString()+e}else if(!n.preload)return;var i=$(this).data("winlet").match(AeJSEngine.reWinlet),r=AeJSEngine.hashGroupsByUri[i[2]];null==r&&(r={idx:e,views:{}},AeJSEngine.hashGroupsByUri[i[2]]=r),r.views[i[3]]=t,AeJSEngine.hashGroupByRootWindow[t]=r;var a=$(this).children("div#ap_win_"+t);if(0==a.length&&(a=$("<div id='ap_win_"+t+"'></div>"),$(this).append(a)),a[0].settings={hashgroup:r.idx,dialog:"no",close:"",url:"",params:null==i[5]?null:$.deparam(i[5])},i.length>7&&null!=i[7]&&""!=i[7]){var o,l=i[7].split(",");for(o=0;o<l.length;o++){var s=l[o].match(AeJSEngine.reWinletParam);a[0].settings[s[1]]=s[2]}}a[0].settings.url="/"+i[1],n.preload?(a.html(AeJSEngine.procWinFunc(a.html())),$(function(){AeJSEngine.enableForm(a)})):AeJSEngine.loadContent(t,!1,!0)};$("div[data-winlet]").each(t),n.preload=!1,n.start=n.maxIdx+1,$("div[data-winlet]").each(t)}},win$={getParams:function(e,n){try{if("string"==typeof e){if(0==e.indexOf("{"))return $.parseJSON(e);if(e.indexOf("=")>0)return $.deparam(e);e=$('form[name="'+e+n+'"]')}if(e.is("form"))return $.deparam(e.serialize())}catch(t){}return e},_wid:function(e){return e},_post:function(e,n){var t={},i=[];"object"==typeof n&&(null!=n.hash&&AeJSEngine.setHash(e,n.hash),n=n.action);for(var r=2;r<arguments.length;r++)null!=arguments[r]&&("function"==typeof arguments[r]?i[i.length]=arguments[r]:$.extend(t,win$.getParams(arguments[r],e)));$.ajax({type:"POST",url:AeJSEngine.getWinSettings(e).url,data:AeJSEngine.mergeParam(e,t,{_x:"y",_w:e,_a:n,_pg:window.location.pathname,_purl:window.location.href}),success:AeJSEngine.getActionResponseHandler(e,i),error:AeJSEngine.getErrorHandler(e),dataType:"html"})},_ajax:function(e,n){$.ajax(n(e))},_get:function(e,n){var t=!0,i=null;if(null!=n)if("object"==typeof n)for(var r in n)"reload"==r&&(t=n[r]),"update"==r&&(i=n[r]);else i=n;for(var a={},o=2;o<arguments.length;o++)$.extend(a,win$.getParams(arguments[o],e));var l=!1;i&&i.indexOf("!")>=0&&(l=!0),AeJSEngine.setHash(e,a),t&&AeJSEngine.loadContent(e,!l),i&&AeJSEngine.updateWindows(e,i)},_toggle:function(e,n){for(var t={},i=2;i<arguments.length;i++)$.extend(t,win$.getParams(arguments[i],e));AeJSEngine.setHash(e,t,!0),AeJSEngine.loadContent(e),AeJSEngine.updateWindows(e,n)},_url:function(e,n){for(var t={},i=2;i<arguments.length;i++)$.extend(t,win$.getParams(arguments[i],e));return AeJSEngine.getWinSettings(e).url+"?"+AeJSEngine.mergeParam(e,t,{_x:"y",_w:e,_a:n,_pg:window.location.pathname,_purl:window.location.href})},reAction:new RegExp("^(.*)!(.*)$"),_submit:function(e,n,t){var i=$('form[name="'+n+e+'"]');if(1==i.length){if(null!=t&&""!=t){if(!i.attr("action").match(win$.reAction))return;i.attr("action",i.attr("action").replace(win$.reAction,"$1!"+t))}for(var r={},a=3;a<arguments.length;a++)null!=arguments[a]&&$.extend(r,win$.getParams(arguments[a],e));for(var o in r)i.find("input[name="+o+"]").attr("value",r[o]);i.submit()}},_aftersubmit:function(e,n){var t=$('form[name="'+n+e+'"]');if(1==t.length){for(var i=[],r=2;r<arguments.length;r++)null!=arguments[r]&&"function"==typeof arguments[r]&&(i[i.length]=arguments[r]);t[0].aftersubmit=i}},wait:function(e,n){var t=(new Date).getTime(),i=$.Deferred();return function(){void 0==$(e)?null!=n&&(new Date).getTime()-t>n?i.reject():window.setTimeout(arguments.callee,300):i.resolve()}(),i.promise()}};$(window).hashchange(function(){AeJSEngine.detectHashChange?AeJSEngine.init():AeJSEngine.detectHashChange=!0});
AeJSEngine.getDialog=function(a){if(null!=a){var e=$("div#ap_win_"+a+"_dialog");return 0==e.length&&(e=$('<div class="modal fade" id="ap_win_'+a+'_dialog" tabindex="-1" role="dialog" aria-hidden="true"><div class="modal-dialog"><div class="modal-content"><div class="modal-header"><button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button><h4 class="modal-title">&nbsp;</h4></div><div class="modal-body">Body</div><div class="modal-footer">&nbsp;</div></div></div></div>'),$("div#ap_win_"+a).append(e)),e}return null==AeJSEngine.dlg&&(AeJSEngine.dlg=$('<div class="modal fade" id="AeDialog" tabindex="-1" role="dialog" aria-hidden="true"><div class="modal-dialog"><div class="modal-content"><div class="modal-header"><button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button><h4 class="modal-title">&nbsp;</h4></div><div class="modal-body">Body</div><div class="modal-footer">&nbsp;</div></div></div></div>'),$(document.body).append(AeJSEngine.dlg)),AeJSEngine.dlg},AeJSEngine.closeDialog=function(a){var e=AeJSEngine.getDialog(a);try{e.hasClass("in")&&e.modal("hide")}catch(n){}e.find("div.modal-body").empty()},AeJSEngine.openDialog=function(a,e,n,i){var t=AeJSEngine.getDialog(a?null:e),d=t.find("div.modal-body"),l=$.trim(AeJSEngine.procStyle(AeJSEngine.procWinFunc(n.replace(AeJSEngine.reScriptAll,"").replace(AeJSEngine.reDialogSetting,""),e)));if(!a&&""==l)return AeJSEngine.closeDialog(e),void 0;d.empty().append(l);var o=AeJSEngine.reDialogSetting.exec(n);if(null!=o){o=JSON.parse(AeJSEngine.procWinFunc(o[1],e)),t.find("h4.modal-title").empty().append(o.title);for(var s=t.find("div.modal-footer").empty(),r=0;r<o.buttons.length;r++){var c="<button";for(var g in o.buttons[r])"label"!=g&&(c=c+" "+g+'="'+o.buttons[r][g]+'"');c=c+">"+o.buttons[r].label+"</button>",s.append(c)}}else null!=i&&t.find("h4.modal-title").empty().append(i);$(function(){var a=null;d.find("form[data-winlet-wid]").each(function(){var e=$(this);e.winform({wid:e.attr("data-winlet-wid"),focus:e.attr("data-winlet-focus"),update:e.attr("data-winlet-update"),validate:e.attr("data-winlet-validate"),hideloading:e.attr("data-winlet-hideloading"),dialog:t}),e.attr("data-winlet-focus")&&(a=e.find('input[name="'+e.attr("data-winlet-focus")+'"]'))}),AeJSEngine.procScript(e,n),a&&t.off("shown.bs.modal").on("shown.bs.modal",function(){a.select(),a.focus()}),t.modal("show")})},AeJSEngine.form.validateSuccess=function(a){var e=AeJSEngine.form.getInputResult(a);if(null!=e){var n=$(a).parents("div.form-group");n.length>0&&$(n[0]).removeClass("has-error").addClass("has-success")}},AeJSEngine.form.validateError=function(){var a=AeJSEngine.form.validateError;return function(e,n){a(e,n);var i=AeJSEngine.form.getInputResult(e);if(null!=i){var t=$(e).parents("div.form-group");t.length>0&&$(t[0]).removeClass("has-success").addClass("has-error")}}}();
var AeEditDrag={R_DRAG_ELEMENT_TYPE:new RegExp("aedrag_(\\S+)"),m_arrAreas:null,m_arrAreaRects:null,m_arrConts:null,m_arrContRects:null,m_elmMove:null,m_elmDropIndicate:null,m_elmArea:null,m_elmContent:null,m_elmContentRect:null,m_offsetMove:null,m_defaultConfig:{indicatorClass:"ae_drop",isVertical:!0,moveAfterDrag:!0,showDropLocation:!0,dragStart:function(){},dragEnd:function(){},dragged:function(){}},m_configs:{},config:function(e,t){AeEditDrag.m_configs[e]=$.extend({},AeEditDrag.m_defaultConfig,t)},getConfig:function(){var e=AeEditDrag.m_elmContent.drag_data_group;return null==AeEditDrag.m_configs[e]&&AeEditDrag.config(e,{}),AeEditDrag.m_configs[e]},initArrObjects:function(e){if(null!=e){var t=e.className.match(AeEditDrag.R_DRAG_ELEMENT_TYPE);null!=t&&(e.drag_element_type=t[1],e.drag_data_group=$(e).attr("data-group"),"area"==e.drag_element_type&&(AeEditDrag.m_arrAreas[AeEditDrag.m_arrAreas.length]=e,AeEditDrag.m_arrAreaRects[AeEditDrag.m_arrAreaRects.length]=AeEditDrag.getRect(e),e.container=AeEditDrag.getElement(e,"cont")),"cont"==e.drag_element_type&&(AeEditDrag.m_arrConts[AeEditDrag.m_arrConts.length]=e,AeEditDrag.m_arrContRects[AeEditDrag.m_arrContRects.length]=AeEditDrag.getRect(e)));var r;for(r=0;r<e.children.length;r++)AeEditDrag.initArrObjects(e.children[r])}},initAreasAndContents:function(){AeEditDrag.m_arrAreas=new Array,AeEditDrag.m_arrAreaRects=new Array,AeEditDrag.m_arrConts=new Array,AeEditDrag.m_arrContRects=new Array,AeEditDrag.initArrObjects(window.document.body)},getRect:function(e){var t=$(e),r=t.offset();return r.width=t.outerWidth(),r.height=t.outerHeight(),r.bottom=r.top+r.height,r.right=r.left+r.width,r},getPosiRect:function(e){var t=$(e),r=t.position();return r.width=t.outerWidth(),r.height=t.outerHeight(),r.bottom=r.top+r.height,r.right=r.left+r.width,r},clearSelection:function(){try{window.getSelection?window.getSelection().empty?window.getSelection().empty():window.getSelection().removeAllRanges&&window.getSelection().removeAllRanges():document.selection&&document.selection.empty()}catch(e){}},newRect:function(e,t,r,n){return{top:e,left:t,bottom:r,right:n,width:n-t,height:r-e}},getElement:function(e,t,r){if(!t)return null;for(;e;){if(e.drag_element_type==t&&(void 0==r||null==r||e.drag_data_group==r))return e;e=e.parentNode}return null},findArea:function(e,t,r){var n;for(n=AeEditDrag.m_arrAreaRects.length-1;n>=0;n--)if(e>=AeEditDrag.m_arrAreaRects[n].left&&e<=AeEditDrag.m_arrAreaRects[n].right&&t>=AeEditDrag.m_arrAreaRects[n].top&&t<=AeEditDrag.m_arrAreaRects[n].bottom&&(void 0==r||null==r||AeEditDrag.m_arrAreas[n].drag_data_group==r))return AeEditDrag.m_arrAreas[n];return null},findCont:function(e,t,r){var n;for(n=AeEditDrag.m_arrContRects.length-1;n>=0;n--)if(e>=AeEditDrag.m_arrContRects[n].left&&e<=AeEditDrag.m_arrContRects[n].right&&t>=AeEditDrag.m_arrContRects[n].top&&t<=AeEditDrag.m_arrContRects[n].bottom&&(void 0==r||null==r||AeEditDrag.m_arrConts[n].drag_data_group==r))return n;return null},doMouseDown:function(e){if(1==e.which&&(AeEditDrag.initAreasAndContents(),AeEditDrag.m_elmContent=AeEditDrag.getElement(e.target,"cont"),null!=AeEditDrag.m_elmContent)){AeEditDrag.m_elmArea=AeEditDrag.getElement(AeEditDrag.m_elmContent,"area",AeEditDrag.m_elmContent.drag_data_group),AeEditDrag.getConfig().dragStart(AeEditDrag.m_elmContent),AeEditDrag.m_elmContentRect=AeEditDrag.getRect(AeEditDrag.m_elmContent);var t=AeEditDrag.getPosiRect(AeEditDrag.m_elmContent);AeEditDrag.m_elmMove=$("<div></div>"),AeEditDrag.m_elmMove.append($(AeEditDrag.m_elmContent).clone()),AeEditDrag.m_elmMove.addClass("ae_drag"),AeEditDrag.m_elmMove.css("left",t.left),AeEditDrag.m_elmMove.css("top",t.top),AeEditDrag.m_elmMove.css("width",t.width),AeEditDrag.m_offsetMove=new Object,AeEditDrag.m_offsetMove.x=t.left-e.pageX,AeEditDrag.m_offsetMove.y=t.top-e.pageY,$(AeEditDrag.m_elmContent.parentNode).append(AeEditDrag.m_elmMove),$(AeEditDrag.m_elmContent).css("opacity",.5),AeEditDrag.m_elmMove.css("opacity",.5),AeEditDrag.clearSelection()}},findDropLocation:function(e,t){var r=new Object;return r.area=AeEditDrag.findArea(e,t,AeEditDrag.m_elmContent.drag_data_group),null==r.area?null:(contIdx=AeEditDrag.findCont(e,t,AeEditDrag.m_elmContent.drag_data_group),null!=contIdx&&AeEditDrag.m_arrConts[contIdx]!=r.area.container&&(r.content=AeEditDrag.m_arrConts[contIdx],r.before=AeEditDrag.getConfig().isVertical?t<AeEditDrag.m_arrContRects[contIdx].top+AeEditDrag.m_arrContRects[contIdx].height/2:e<AeEditDrag.m_arrContRects[contIdx].left+AeEditDrag.m_arrContRects[contIdx].width/2),r)},showDropPoint:function(e,t){null!=AeEditDrag.m_elmDropIndicate&&AeEditDrag.m_elmDropIndicate.remove();var r=AeEditDrag.findDropLocation(e,t);null!=r&&r.content!=AeEditDrag.m_elmContent&&(null!=r.content||r.area!=AeEditDrag.m_elmArea)&&(AeEditDrag.m_elmDropIndicate=$("<"+AeEditDrag.m_elmContent.nodeName+"></"+AeEditDrag.m_elmContent.nodeName+">"),AeEditDrag.m_elmDropIndicate.addClass(AeEditDrag.getConfig().indicatorClass),null!=r.content?r.before?$(r.content).before(AeEditDrag.m_elmDropIndicate):$(r.content).after(AeEditDrag.m_elmDropIndicate):$(r.area).append(AeEditDrag.m_elmDropIndicate))},doMouseMove:function(e){null!=AeEditDrag.m_elmMove&&null!=AeEditDrag.m_offsetMove&&(AeEditDrag.clearSelection(),AeEditDrag.m_elmMove.css("left",e.pageX+AeEditDrag.m_offsetMove.x),AeEditDrag.m_elmMove.css("top",e.pageY+AeEditDrag.m_offsetMove.y),AeEditDrag.getConfig().showDropLocation&&AeEditDrag.showDropPoint(e.pageX,e.pageY))},doMouseUp:function(e){if(null!=AeEditDrag.m_elmDropIndicate&&AeEditDrag.m_elmDropIndicate.remove(),null!=AeEditDrag.m_elmContent){$(AeEditDrag.m_elmContent).css("opacity",1);var t=AeEditDrag.findDropLocation(e.pageX,e.pageY);null==t||t.content==AeEditDrag.m_elmContent||null==t.content&&t.area==AeEditDrag.m_elmArea?AeEditDrag.getConfig().dragEnd(AeEditDrag.m_elmContent,t):(AeEditDrag.getConfig().moveAfterDrag&&(null==t.content?$(t.area).append(AeEditDrag.m_elmContent):t.before?$(t.content).before(AeEditDrag.m_elmContent):$(t.content).after(AeEditDrag.m_elmContent)),AeEditDrag.getConfig().dragged(AeEditDrag.m_elmContent,t)),AeEditDrag.m_elmContent=null}null!=AeEditDrag.m_elmMove&&(AeEditDrag.m_elmMove.remove(),AeEditDrag.m_elmMove=null)}};$(document).on("AeWindowLoaded",function(e){var t=$(e.target).find(".aedrag_drag");t.css("cursor","move"),t.mousedown(AeEditDrag.doMouseDown),$(document).mousemove(AeEditDrag.doMouseMove),$(document).mouseup(AeEditDrag.doMouseUp)}),function(e){e.fn.AeMenu=function(t,r,n,a){e(this).css({cursor:"context-menu"});var o=e(r);if(0!=o.length){o.css({display:"none"});var i=null;e(this).on(t,function(t){o.data("menusrc",e(this));var r;return null==n?r={top:t.pageY,left:t.pageX}:(null==a&&(a=0),rect=AeEditDrag.getRect(t.target),r="bottomleft"==n?{top:rect.bottom+a,left:rect.left}:"topright"==n?{top:rect.top,left:rect.right+a}:"bottomright"==n?{top:rect.bottom+a,left:rect.right+a}:{top:rect.top,left:rect.left}),null==i&&(o.css({position:"absolute",display:"block",top:0,left:0}),i=o.offset()),o.css({display:"block",top:r.top-i.top,left:r.left-i.left}),e("body").off("mouseup").on("mouseup",function(){return o.css({display:"none"}),e("body").off("mousedown"),!0}),!1})}},e.fn.AeContextMenu=function(t,r,n){e(this).AeMenu("contextmenu",t,r,n)},e.fn.AeClickMenu=function(t,r,n){e(this).AeMenu("click",t,r,n)}}(jQuery);