!function(e,n){"use strict";var t,i;e.uaMatch=function(e){e=e.toLowerCase();var n=/(chrome)[ \/]([\w.]+)/.exec(e)||/(webkit)[ \/]([\w.]+)/.exec(e)||/(opera)(?:.*version|)[ \/]([\w.]+)/.exec(e)||/(msie) ([\w.]+)/.exec(e)||e.indexOf("compatible")<0&&/(mozilla)(?:.*? rv:([\w.]+)|)/.exec(e)||[],t=/(ipad)/.exec(e)||/(iphone)/.exec(e)||/(android)/.exec(e)||[];return{browser:n[1]||"",version:n[2]||"0",platform:t[0]||""}},t=e.uaMatch(n.navigator.userAgent),i={},t.browser&&(i[t.browser]=!0,i.version=t.version),t.platform&&(i[t.platform]=!0),i.chrome?i.webkit=!0:i.webkit&&(i.safari=!0),e.browser=i}(jQuery,window),function(e,n,t){function i(e){return e=e||location.href,"#"+e.replace(/^[^#]*#?(.*)$/,"$1")}var r,a="hashchange",l=document,o=e.event.special,s=l.documentMode,c="on"+a in n&&(s===t||s>7);e.fn[a]=function(e){return e?this.bind(a,e):this.trigger(a)},e.fn[a].delay=50,o[a]=e.extend(o[a],{setup:function(){return c?!1:(e(r.start),void 0)},teardown:function(){return c?!1:(e(r.stop),void 0)}}),r=function(){function r(){var t=i(),l=d(g);t!==g?(p(g=t,l),e(n).trigger(a)):l!==g&&(location.href=location.href.replace(/#.*/,"")+l),o=setTimeout(r,e.fn[a].delay)}var o,s={},g=i(),u=function(e){return e},p=u,d=u;return s.start=function(){o||r()},s.stop=function(){o&&clearTimeout(o),o=t},e.browser.msie&&!c&&function(){var n,t;s.start=function(){n||(t=e.fn[a].src,t=t&&t+i(),n=e('<iframe tabindex="-1" title="empty"/>').hide().one("load",function(){t||p(i()),r()}).attr("src",t||"javascript:0").insertAfter("body")[0].contentWindow,l.onpropertychange=function(){try{"title"===event.propertyName&&(n.document.title=l.title)}catch(e){}})},s.stop=u,d=function(){return i(n.location.href)},p=function(t,i){var r=n.document,o=e.fn[a].domain;t!==i&&(r.title=l.title,r.open(),o&&r.write('<script>document.domain="'+o+'"</script>'),r.close(),n.location.hash=t)}}(),s}()}(jQuery,this),function(e){function n(e){return"string"==typeof e}function t(e){var n=v.call(arguments,1);return function(){return e.apply(this,n.concat(v.call(arguments)))}}function i(e){return e.replace(S,"$2")}function r(e){return e.replace(/(?:^[^?#]*\?([^#]*).*$)?.*/,"$1")}function a(t,i,r,a,l){var o,g,p,d,f;return a!==s?(p=r.match(t?S:/^([^#?]*)\??([^#]*)(#?.*)/),f=p[3]||"",2===l&&n(a)?g=a.replace(t?m:H,""):(d=u(p[2]),a=n(a)?u[t?R:_](a):a,g=2===l?a:1===l?e.extend({},a,d):e.extend({},d,a),g=c(g),t&&(g=g.replace(W,J))),o=p[1]+(t?E:g||!p[1]?"?":"")+g+f):o=i(r!==s?r:location.href),o}function l(e,t,i){return t===s||"boolean"==typeof t?(i=t,t=$[e?R:_]()):t=n(t)?t.replace(e?m:H,""):t,u(t,i)}function o(t,i,r,a){return n(r)||"object"==typeof r||(a=r,r=i,i=s),this.each(function(){var n=e(this),l=i||h()[(this.nodeName||"").toLowerCase()]||"",o=l&&n.attr(l)||"";n.attr(l,$[t](o,r,a))})}var s,c,g,u,p,d,f,h,m,S,W,w,E,v=Array.prototype.slice,J=decodeURIComponent,$=e.param,y=e.bbq=e.bbq||{},b=e.event.special,x="hashchange",_="querystring",R="fragment",j="elemUrlAttr",C="href",T="src",H=/^.*\?|#.*$/g,O={};$[_]=t(a,0,r),$[R]=g=t(a,1,i),$.sorted=c=function(n,t){var i=[],r={};return e.each($(n,t).split("&"),function(e,n){var t=n.replace(/(?:%5B|=).*$/,""),a=r[t];a||(a=r[t]=[],i.push(t)),a.push(n)}),e.map(i.sort(),function(e){return r[e]}).join("&")},g.noEscape=function(n){n=n||"";var t=e.map(n.split(""),encodeURIComponent);W=new RegExp(t.join("|"),"g")},g.noEscape(",/"),g.ajaxCrawlable=function(e){return e!==s&&(e?(m=/^.*(?:#!|#)/,S=/^([^#]*)(?:#!|#)?(.*)$/,E="#!"):(m=/^.*#/,S=/^([^#]*)#?(.*)$/,E="#"),w=!!e),w},g.ajaxCrawlable(0),e.deparam=u=function(n,t){var i={},r={"true":!0,"false":!1,"null":null};return e.each(n.replace(/\+/g," ").split("&"),function(n,a){var l,o=a.split("="),c=J(o[0]),g=i,u=0,p=c.split("]["),d=p.length-1;if(/\[/.test(p[0])&&/\]$/.test(p[d])?(p[d]=p[d].replace(/\]$/,""),p=p.shift().split("[").concat(p),d=p.length-1):d=0,2===o.length)if(l=J(o[1]),t&&(l=l&&!isNaN(l)?+l:"undefined"===l?s:r[l]!==s?r[l]:l),d)for(;d>=u;u++)c=""===p[u]?g.length:p[u],g=g[c]=d>u?g[c]||(p[u+1]&&isNaN(p[u+1])?{}:[]):l;else e.isArray(i[c])?i[c].push(l):i[c]=i[c]!==s?[i[c],l]:l;else c&&(i[c]=t?s:"")}),i},u[_]=t(l,0),u[R]=p=t(l,1),e[j]||(e[j]=function(n){return e.extend(O,n)})({a:C,base:C,iframe:T,img:T,input:T,form:"action",link:C,script:T}),h=e[j],e.fn[_]=t(o,_),e.fn[R]=t(o,R),y.pushState=d=function(e,t){n(e)&&/^#/.test(e)&&t===s&&(t=2);var i=e!==s,r=g(location.href,i?e:{},i?t:2);location.href=r},y.getState=f=function(e,n){return e===s||"boolean"==typeof e?p(e):p(n)[e]},y.removeState=function(n){var t={};n!==s&&(t=f(),e.each(e.isArray(n)?n:arguments,function(e,n){delete t[n]})),d(t,2)},b[x]=e.extend(b[x],{add:function(n){function t(e){var n=e[R]=g();e.getState=function(e,t){return e===s||"boolean"==typeof e?u(n,e):u(n,t)[e]},i.apply(this,arguments)}var i;return e.isFunction(n)?(i=n,t):(i=n.handler,n.handler=t,void 0)}})}(jQuery,this);var win$=function(){function ElmRect(e){if(null==e)return null;var n=e.offset();this.left=n.left,this.top=n.top,this.width=e[0].offsetWidth,this.height=e[0].offsetHeight,this.right=this.left+this.width,this.bottom=this.top+this.height,this.union=function(e){e.left<this.left&&(this.left=e.left),e.right>this.right&&(this.right=e.right),e.top<this.top&&(this.top=e.top),e.bottom>this.bottom&&(this.bottom=e.bottom),this.width=this.right-this.left,this.height=this.bottom-this.top}}var WinletJSEngine={ImgBg:new Image(1,1),ImgLoading:new Image(1,1),ImgValidating:new Image(1,1),topSpace:0,bottomSpace:0,leftSpace:0,rightSpace:0,widCounter:0,isStatic:!1,isApme:!1,detectHashChange:!0,reEscape:/(:|\.|\[|\])/g,reScriptAll:new RegExp("<script.*?>(?:\n|\r|.)*?</script>","img"),reScriptOne:new RegExp("<script(.*?)>((?:\n|\r|.)*?)</script>","im"),reScriptLanguage:new RegExp('.*?language.*?=.*?"(.*?)"',"im"),reScriptSrc:new RegExp('.*?src.*?=.*?"(.*?)"',"im"),reScriptType:new RegExp('.*?type.*?=.*?"(.*?)"',"im"),reScriptCharset:new RegExp('.*?charset.*?=.*?"(.*?)"',"im"),reCSSAll:new RegExp('<link.*?type="text/css".*?>',"img"),reCSSHref:new RegExp('.*?href="(.*?)"',"im"),reWinWinlet:new RegExp("win\\$\\.winlet\\s*\\(","img"),reWinContainer:new RegExp("win\\$\\.container\\s*\\(","img"),reWinPost:new RegExp("win\\$\\.post\\s*\\(","img"),reWinEmbed:new RegExp("win\\$\\.embed\\s*\\(","img"),reWinInclude:new RegExp("win\\$\\.include\\s*\\(","img"),reWinAjax:new RegExp("win\\$\\.ajax\\s*\\(","img"),reWinGet:new RegExp("win\\$\\.get\\s*\\(","img"),reWinToggle:new RegExp("win\\$\\.toggle\\s*\\(","img"),reWinUrl:new RegExp("win\\$\\.url\\s*\\(","img"),reWinSubmit:new RegExp("win\\$\\.submit\\s*\\(","img"),reWinFind:new RegExp("win\\$\\.find\\s*\\(","img"),reWinWait:new RegExp("win\\$\\.wait\\s*\\(","img"),reWinAfterSubmit:new RegExp("win\\$\\.aftersubmit\\s*\\(","img"),reWinlet:new RegExp("^\\s*(((/\\w+)?/.+/)\\w+)(\\?([^\\s]+))?(\\s+(.*?))?$"),reWinletParam:new RegExp("(\\w+)\\:(\\w+)"),reDialogSetting:new RegExp('<div id="winlet_dialog"[^>]*>(.*?)</div>',"img"),reWinletHeader:new RegExp('<div id="winlet_header"[^>]*>(.*?)</div>',"img"),reMetaTitle:new RegExp('<meta\\s+name\\s*=\\s*"\\s*title\\s*"\\s+content=\\s*"([^"]+)"[^>]*>'),reMeta:new RegExp('<meta\\s+(name|property)\\s*=\\s*"[^"]*"\\s+content=\\s*"[^"]+"[^>]*>'),reAction:new RegExp("^(.*)\\?_a=(.*)$"),form:{createResultHolder:function(e){return null!=e.m_result?e.m_result:(e.name&&(e.m_result=$(e.form).find("span.validate_result[data-input='"+e.name.replace("[","\\[").replace("]","\\]").replace(".","\\.")+"']")),(null==e.m_result||0==e.m_result.length)&&(e.m_result=$('<span class="validate_result"></span>'),$(e).after(e.m_result)),void 0)},getInputResult:function(e){if(e instanceof jQuery){if(0==e.length)return null;e=e[0]}return null==e.m_result&&WinletJSEngine.form.createResultHolder(e),e.m_result},updateValidate:function(e){if(e instanceof jQuery){if(!(e.length>0))return;e=e[0]}e.updateValidate&&e.updateValidate()},validateClearAll:function(e){var n=e instanceof jQuery?e:$(e);n.find("span.validate_result").each(function(){$(this).html("")})},validateClear:function(){for(var e=0;e<arguments.length;e++){var n=WinletJSEngine.form.getInputResult(arguments[e]);null!=n&&n.html("")}},validating:function(){},validateSuccess:function(e){var n=WinletJSEngine.form.getInputResult(e);null!=n&&n.html('<span class="win_valpassed">&nbsp;</span>')},validateError:function(e,n){var t=WinletJSEngine.form.getInputResult(e);if(null!=t){var i=t.find("div.win_valfailed");0==i.length&&(t.html("<div class='win_valfailed'></div>"),i=t.find("div.win_valfailed")),i.text(n)}},applyChanges:function(json,form,input){var changes=null;try{changes=eval(json)}catch(e){}if(null!=changes){for(var errors=[],i=0;i<changes.length;i++){var inp=$(form).find(":input[name='"+changes[i].input+"']");if(0==inp.length&&(inp=$("#"+changes[i].input)),inp=0==inp.length?null:inp[0],"v"==changes[i].type){if(""!=changes[i].message)if(null!=inp)WinletJSEngine.form.validateClear(inp),WinletJSEngine.form.validateError(inp,changes[i].message),errors.push($(inp));else{var result=$(form).find("span.validate_result[data-input='"+changes[i].input+"']");result.length>0&&(inp={m_result:result},WinletJSEngine.form.validateClear(inp),WinletJSEngine.form.validateError(inp,changes[i].message),errors.push(result))}}else if(null!=inp)if("u"==changes[i].type)"radio"==inp.type?$(form).children(":input[name='"+changes[i].input+"'][value='"+changes[i].value+"']").attr("checked","checked"):"checkbox"==inp.type?inp.checked=changes[i].value:(input==inp&&WinletJSEngine.form.validateSuccess(input),$(inp).val(changes[i].value));else if("d"==changes[i].type)inp.disabled=!0,WinletJSEngine.form.validateClear(inp);else if("e"==changes[i].type)inp.disabled=!1;else if("l"==changes[i].type&&(inp.type="select")){$(inp).empty();for(var j=0;j<changes[i].list.length;j++)$(inp).append('<option value="'+changes[i].list[j].id+'">'+changes[i].list[j].name+"</option>")}}errors.length>0&&(WinletJSEngine.ensureVisible(errors),errors[0].select().focus())}},getValidateResponseHandler:function(e,n,t){return function(n){if(WinletJSEngine.form.validateClear(t),WinletJSEngine.form.applyChanges(n,e,t),void 0!=e.onerror&&void 0!=t)try{e.onerror(t)}catch(i){}}},showTip:function(e){var n=WinletJSEngine.form.getInputResult(e);null!=n&&""==n.html()&&n.html('<div class="win_tips">'+$(this).attr("tips")+"</div>")},hideTip:function(e){var n=WinletJSEngine.form.getInputResult(e);null!=n&&n.find("div.win_tips").length>0&&n.html("")}},parseJson:function(str){return str&&""!=str.trim()?JSON?JSON.parse(str):eval(str):{}},startsWith:function(e,n){return null!=e&&"string"==typeof e&&n&&e.slice(0,n.length)==n},endsWith:function(e,n){return null!=e&&"string"==typeof e&&n&&e.slice(-n.length)==n},_utf8_decode:function(e){if(null==e)return null;e=unescape(e);for(var n="",t=0,i=c1=c2=0;t<e.length;)i=e.charCodeAt(t),128>i?(n+=String.fromCharCode(i),t++):i>191&&224>i?(c2=e.charCodeAt(t+1),n+=String.fromCharCode((31&i)<<6|63&c2),t+=2):(c2=e.charCodeAt(t+1),c3=e.charCodeAt(t+2),n+=String.fromCharCode((15&i)<<12|(63&c2)<<6|63&c3),t+=3);return n},setSessionId:function(e){WinletJSEngine.winletDomain&&("undefined"!=typeof sessionStorage?sessionStorage.winlet_session_id=e:document.cookie="WINLET_SESSION_ID="+e)},getSessionId:function(){return WinletJSEngine.winletDomain?"undefined"!=typeof sessionStorage?sessionStorage.winlet_session_id:decodeURIComponent(document.cookie.replace(new RegExp("(?:(?:^|.*;)\\s*"+encodeURIComponent("WINLET_SESSION_ID").replace(/[\-\.\+\*]/g,"\\$&")+"\\s*\\=\\s*([^;]*).*$)|^.*$"),"$1"))||null:null},getForm:function(e,n){if(null==e||null==n||0==e.length)return null;var t=e.find('form[name="'+n+'"]');return null!=t&&t.length>0?t:(null!=e[0].dlg&&(t=e[0].dlg.find('form[name="'+n+'"]')),t)},isRootWinlet:function(e){return null!=e.data("winlet-url")&&0==e.parent().closest("div[data-winlet-url]").length},getContainer:function(e){if(null==e)return null;var n=null;return n="number"==typeof e?$('div[data-winlet-id="'+e+'"]'):"string"==typeof e&&e.match(/^\d+$/)?$('div[data-winlet-id="'+e+'"]'):e instanceof jQuery?e.closest("div[data-winlet-id]"):$(e).closest("div[data-winlet-id]"),1!=n.length?null:n},traceToWinlet:function(e){return null==e||0==e.length?null:null!=e.data("winlet-url")?e:WinletJSEngine.traceToWinlet($('div[data-winlet-id="'+e.data("winlet-src-id")+'"]'))},getWinlet:function(e){return WinletJSEngine.traceToWinlet(WinletJSEngine.getContainer(e))},getWinletUrl:function(e,n){n&&0==!n.indexOf("/")&&(n="/"+n);var t=null==n?0:(n.match(/\//g)||[]).length;if(3==t)return n;var i=WinletJSEngine.traceToWinlet(e);if(null==i)return null;if(!n)return i.data("winlet-url");switch(t){case 1:return WinletJSEngine.getWinletRoot(i)+n.substring(1);case 2:return WinletJSEngine.getContextRoot(i)+n.substring(1)}return n},winletRootMap:{},getWinletRoot:function(e){try{var n=WinletJSEngine.getWinletUrl(e);return null==WinletJSEngine.winletRootMap[n]&&(WinletJSEngine.winletRootMap[n]=n.match(WinletJSEngine.reWinlet)[2]),WinletJSEngine.winletRootMap[n]}catch(t){return null}},contextRootMap:{},getContextRoot:function(e){try{var n=WinletJSEngine.getWinletUrl(e);return null==WinletJSEngine.contextRootMap[n]&&(WinletJSEngine.contextRootMap[n]=n.match(WinletJSEngine.reWinlet)[3],WinletJSEngine.contextRootMap[n]=null==WinletJSEngine.contextRootMap[n]?"/":WinletJSEngine.contextRootMap[n]+"/"),WinletJSEngine.contextRootMap[n]}catch(t){return null}},hashGroupMap:{},getHashGroup:function(e){try{var n=WinletJSEngine.getWinletRoot(e);if(null==WinletJSEngine.hashGroupMap[n]){var t=0;for(var i in WinletJSEngine.hashGroupMap)WinletJSEngine.hashGroupMap.hasOwnProperty(i)&&++t;WinletJSEngine.hashGroupMap[n]=t+1}return WinletJSEngine.hashGroupMap[n]}catch(r){return null}},getFullUrl:function(e){if(WinletJSEngine.winletDomain){var n=WinletJSEngine.getSessionId();if(null==n)return WinletJSEngine.winletDomain+e;var t=e.indexOf("?");return 0>=t?WinletJSEngine.winletDomain+e+";jsessionid="+n:WinletJSEngine.winletDomain+e.substr(0,t)+";jsessionid="+n+e.substr(t)}return e},getWinSettings:function(e){var n=WinletJSEngine.traceToWinlet(e);if(null==n)return{};var t=n.data("winlet-settings");return null==t?{}:"string"==typeof t||t instanceof String?WinletJSEngine.parseJson(t):t},getHash:function(e){var n=WinletJSEngine.getHashGroup(e);try{var t=window.location.toString().split("#")[1];0==t.indexOf("!")&&(t=t.substring(1));var i=$.deparam(t);if("root"==n){var r={};for(var a in i){var l=!0;if(i.hasOwnProperty(a)||(l=!1),l&&"object"==typeof i[a])if("[object Array]"!==Object.prototype.toString.call(i[a]))l=!1;else for(var o=0;o<i[a].length;o++)if("string"!=typeof i[a][o]&&"number"!=typeof i[a][o]){l=!1;break}l&&(r[a]=i[a])}return r}return i[n]}catch(s){}return null},setHash:function(e,n,t,i){var r=WinletJSEngine.getHashGroup(e),a=null;try{var l=window.location.toString().split("#")[1];0==l.indexOf("!")&&(l=l.substring(1)),a=$.deparam(l)}catch(o){}a instanceof Object||(a={});var s=a;if("root"!=r&&(void 0==a[r]&&(a[r]={}),s=a[r]),t)for(property in n)$.isArray(n[property])?$.isArray(s[property])?$.each(n[property],function(e,n){n=""+n;var t=$.inArray(n,s[property]);0>t?s[property].push(n):s[property].splice(t,1)}):s[property]=n[property]:s[property]==n[property]?delete s[property]:s[property]=n[property];else if(i){var c=WinletJSEngine.getHash(e);for(property in c)delete s[property];$.extend(s,n)}else $.extend(s,n);for(property in s)""==s[property]&&delete s[property];WinletJSEngine.detectHashChange=!1;var g=$.param(a);window.location.hash="!"+g},getParam:function(e){if(null==e||0==e.length)return{};var n=null;n=null!=e.data("winlet-src-id")?$('div[data-winlet-id="'+e.data("winlet-src-id")+'"]'):e.parent().closest("div[data-winlet-id], div[data-winlet-src-id]");var t={};n.length>0&&$.extend(t,WinletJSEngine.getParam(n));var i=e.attr("data-winlet-params");return null!=i&&("string"==typeof i?$.extend(t,WinletJSEngine.parseJson(i)):$.extend(t,i)),t},mergeParam:function(e){var n={};$.extend(n,WinletJSEngine.getParam(e));var t=window.location.href.indexOf("?");if(t>0){var i=window.location.href.substr(t+1);t=i.indexOf("#"),t>0&&(i=i.substr(0,t)),$.extend(n,$.deparam(i))}try{$.extend(n,WinletJSEngine.getHash(e))}catch(r){}for(var a=1;a<arguments.length;a++)null!=arguments[a]&&$.extend(n,arguments[a]);return $.param(n,!0)},getViewport:function(){var e={},n=document.documentElement;return e.left=(window.pageXOffset||n.scrollLeft)-(n.clientLeft||0),e.top=(window.pageYOffset||n.scrollTop)-(n.clientTop||0),e.width=n.clientWidth,e.height=n.clientHeight,e.left+=WinletJSEngine.leftSpace,e.width-=WinletJSEngine.leftSpace+WinletJSEngine.rightSpace,e.top+=WinletJSEngine.topSpace,e.height-=WinletJSEngine.topSpace+WinletJSEngine.bottomSpace,e.width<0&&(e.width=0),e.height<0&&(e.height=0),e.bottom=e.top+e.height,e.right=e.left+e.width,e},getPositionInViewport:function(e){var n=WinletJSEngine.getViewport(),t=new ElmRect(e);return t.left=t.left-n.left,t.top=t.top-n.top,t.right=t.right-n.left,t.bottom=t.bottom-n.top,t.viewport=n,t},ensureVisible:function(e){try{var n=document.documentElement,t=(window.pageXOffset||n.scrollLeft)-(n.clientLeft||0),i=(window.pageYOffset||n.scrollTop)-(n.clientTop||0),r={};if("[object Array]"===Object.prototype.toString.call(e)){if(0==e.length)return;r=new ElmRect(e[0]);for(var a=1;a<e.length;a++)r.union(new ElmRect(e[a]))}else r=new ElmRect(e);r.top-=WinletJSEngine.topSpace,r.bottom+=WinletJSEngine.bottomSpace,r.left-=WinletJSEngine.leftSpace,r.right+=WinletJSEngine.rightSpace,r.bottom+=2;var l=0;t+n.clientWidth<r.right&&(l=r.right-t-n.clientWidth),t+l>r.left&&(l=r.left-t);var o=0;i+n.clientHeight<r.bottom&&(o=r.bottom-i-n.clientHeight),i+o>r.top&&(o=r.top-i),(0!=l||0!=o)&&(0!=o&&$("html,body").stop().animate({scrollTop:"+="+o},500),0!=l&&$("html,body").stop().animate({scrollLeft:"+="+l},500))}catch(s){}},clearLoading:function(e){try{e[0].loading&&(e[0].loading.remove(),e[0].loading=null)}catch(n){}},showLoading:function(e,n,t){try{WinletJSEngine.clearLoading(e);var i=new ElmRect(e);try{null!=n&&(i=new ElmRect(n))}catch(r){}null!=WinletJSEngine.ImgLoading.src&&""!=WinletJSEngine.ImgLoading.src&&null!=WinletJSEngine.ImgBg.src&&""!=WinletJSEngine.ImgBg.src&&(e[0].loading=$("<div style='z-index:100000;position:absolute;background:url("+WinletJSEngine.ImgBg.src+");left:"+i.left+"px;top:"+i.top+"px;width:"+i.width+"px;height:"+i.height+"px'><table width='100%' height='100%' border='0'><tr height='100%'><td align='center' valign='middle'><img src='"+WinletJSEngine.ImgLoading.src+"'/></td></tr></table></div>"),t||e[0].loading.css("opacity","0"),e[0].loading.appendTo("body"),t||setTimeout(function(){e[0].loading&&e[0].loading.css("opacity","1")},1e3))}catch(r){}},procStyle:function(e){var n,t,i,r=e.match(WinletJSEngine.reCSSAll)||[],a=$.map(r,function(e){return(e.match(WinletJSEngine.reCSSHref)||["",""])[1]}),l=document.getElementsByTagName("head")[0],o=l.getElementsByTagName("link");for(n=0;n<a.length;n++)if(""!=a[n]){for(t=0;t<o.length&&o[t].href!=a[n];t++);t<o.length||(i=document.createElement("link"),i.type="text/css",i.rel="stylesheet",i.href=a[n],i.media="screen",l.appendChild(i))}return e.replace(WinletJSEngine.reCSSAll,"")},procWinFunc:function(e,n){var t=n.data("winlet-id");return null==t?null:e.replace(WinletJSEngine.reWinPost,"win$._post("+t+", null, ").replace(WinletJSEngine.reWinEmbed,"win$._post("+t+", ").replace(WinletJSEngine.reWinInclude,"win$._include("+t+", ").replace(WinletJSEngine.reWinWinlet,"win$._winlet("+t).replace(WinletJSEngine.reWinContainer,"win$._container("+t).replace(WinletJSEngine.reWinAjax,"win$._ajax("+t+", ").replace(WinletJSEngine.reWinGet,"win$._get("+t+", ").replace(WinletJSEngine.reWinToggle,"win$._toggle("+t+", ").replace(WinletJSEngine.reWinUrl,"win$._url("+t+", ").replace(WinletJSEngine.reWinSubmit,"win$._submit("+t+", ").replace(WinletJSEngine.reWinFind,"win$._find("+t+", ").replace(WinletJSEngine.reWinWait,"win$._wait("+t+", ").replace(WinletJSEngine.reWinAfterSubmit,"win$._aftersubmit("+t+", ")},procScript:function(cont,$container){var containerId=$container.data("winlet-id");if(containerId=null)return null;var scripts=cont.match(WinletJSEngine.reScriptAll)||[],scriptContent=$.map(scripts,function(e){return(e.match(WinletJSEngine.reScriptOne)||["","",""])[2]}),scriptDef=$.map(scripts,function(e){return(e.match(WinletJSEngine.reScriptOne)||["","",""])[1]}),scriptLanguage=$.map(scriptDef,function(e){return(e.match(WinletJSEngine.reScriptLanguage)||["",""])[1]}),scriptSrc=$.map(scriptDef,function(e){return(e.match(WinletJSEngine.reScriptSrc)||["",""])[1]}),scriptType=$.map(scriptDef,function(e){return(e.match(WinletJSEngine.reScriptType)||["",""])[1]}),scriptCharset=$.map(scriptDef,function(e){return(e.match(WinletJSEngine.reScriptCharset)||["",""])[1]}),elmHead=document.getElementsByTagName("head")[0],elmScripts=$("script"),i,j,ret=[];for(i=0;i<scripts.length;i++)if(""!=scriptSrc[i]){for(j=0;j<elmScripts.length&&elmScripts[j].src!=scriptSrc[i];j++);if(!(j<elmScripts.length)){var dfd=$.Deferred(),newScript=document.createElement("script");newScript.type=""!=scriptType[i]?scriptType[i]:""!=scriptLanguage[i]?"text/"+scriptLanguage[i]:"text/javascript",""!=scriptCharset[i]&&(newScript.charset=scriptCharset[i]),$(newScript).load(function(){dfd.resolve()}).on("readystatechange",function(){"loaded"==newScript.readyState&&dfd.resolve()}),elmHead.appendChild(newScript),newScript.src=scriptSrc[i],ret[ret.length]=dfd.promise()}}$.when.apply($,ret).done(function(){for(i=0;i<scriptContent.length;i++)try{eval(WinletJSEngine.procWinFunc(scriptContent[i],$container))}catch(e){alert(e.message),alert(scriptContent[i])}})},invokeAfterLoad:function(e){if(WinletJSEngine.afterLoad)try{WinletJSEngine.afterLoad(e)}catch(n){}},enableForm:function(e){e.find("form").filter(function(){for(var e=this.attributes,n=0;n<e.length;n++)if(0==e[n].name.indexOf("data-winlet-"))return!0;return!1}).each(function(){var n=$(this),t=WinletJSEngine.getContainer(n),i={focus:n.attr("data-winlet-focus"),update:n.attr("data-winlet-update"),validate:n.attr("data-winlet-validate"),hideloading:n.attr("data-winlet-hideloading"),container:null==t?e:t};(null==i.validate||""==i.validate)&&(i.validate="form"),n.winform(i)})},updateHref:function($container){$container.find("a[data-winlet-href]").each(function(){var $this=$(this),href=$this.data("winlet-href");if(WinletJSEngine.startsWith(href,"javascript:"))$this.attr("href",href);else try{$this.attr("href",eval(href))}catch(e){}})},getWinletResponseHeaders:function(e,n){var t={};if(t.redirect=n.getResponseHeader("X-Winlet-Redirect"),t.update=n.getResponseHeader("X-Winlet-Update"),t.dialog=n.getResponseHeader("X-Winlet-Dialog"),t.cache=n.getResponseHeader("X-Winlet-Cache"),t.title=WinletJSEngine._utf8_decode(n.getResponseHeader("X-Winlet-Title")),WinletJSEngine.winletDomain&&e){var i=WinletJSEngine.reWinletHeader.exec(e);i&&(e=e.replace(WinletJSEngine.reWinletHeader,""),i=JSON.parse(i[1]),i["X-Winlet-Redirect"]&&(t.redirect=i["X-Winlet-Redirect"]),i["X-Winlet-Update"]&&(t.update=i["X-Winlet-Update"]),i["X-Winlet-Dialog"]&&(t.dialog=i["X-Winlet-Dialog"]),i["X-Winlet-Cache"]&&(t.cache=i["X-Winlet-Cache"]),i["X-Winlet-Title"]&&(t.title=i["X-Winlet-Title"]),i["X-Winlet-Session-ID"]&&WinletJSEngine.setSessionId(i["X-Winlet-Session-ID"]))}return t},getWindowResponseHandler:function(e,n){var t=WinletJSEngine.traceToWinlet(e);return function(i,r,a){var l=WinletJSEngine.getWinletResponseHeaders(i,a);if(i){i=i.replace(WinletJSEngine.reWinletHeader,"");var o=i.match(WinletJSEngine.reMetaTitle);o&&(document.title=o[1]),i=i.replace(WinletJSEngine.reMeta,"")}if(0!=e.length){if(null!=l.redirect&&""!=l.redirect)return location.href=l.redirect,void 0;var s=!1;WinletJSEngine.isRootWinlet(e)&&"yes"==WinletJSEngine.getWinSettings(e).dialog?(s=!0,WinletJSEngine.openDialog(e,i,l.title)):(e.html(WinletJSEngine.procStyle(WinletJSEngine.procWinFunc(i.replace(WinletJSEngine.reScriptAll,""),e,null))),$(function(){WinletJSEngine.enableForm(e),WinletJSEngine.updateHref(e)}),WinletJSEngine.procScript(i,e,null)),WinletJSEngine.invokeAfterLoad(e),WinletJSEngine.clearLoading(e),t&&t.trigger("WinletWindowLoaded",t),!s&&n&&WinletJSEngine.ensureVisible(e)}}},loadContent:function(e,n,t,i){var r=$.Deferred(),a=WinletJSEngine.traceToWinlet(e);if(null==a)return r.reject().promise();var l=WinletJSEngine.getHash(a);if(!t&&i){var o=a[0].hashParams;if(null==l&&null==o)return r.resolve().promise();if(null!=l&&null!=o&&Object.keys(l).length==Object.keys(o).length){var s=!0;for(var c in l)if("[object Array]"===Object.prototype.toString.call(l[c]))"[object Array]"===!Object.prototype.toString.call(o[c])?s=!1:(0!=$(l[c]).not(o[c]).length||0!=$(o[c]).not(l[c]).length)&&(s=!1);else if(l[c]!=o[c]){s=!1;break}if(s)return r.resolve().promise()}}return a[0].hashParams=l,WinletJSEngine.showLoading(a),$.ajax({type:"POST",url:WinletJSEngine.getFullUrl(WinletJSEngine.getWinletUrl(a)),data:WinletJSEngine.mergeParam(a,{_x:"y",_pg:window.location.pathname,_purl:window.location.href,_pr:t?"yes":"no"}),success:function(e,t,i){WinletJSEngine.getWindowResponseHandler(a,n)(e,t,i),r.resolve()},error:function(e,n,t){WinletJSEngine.getErrorHandler(a)(e,n,t),r.reject()},dataType:"html"}),r.promise()},updateWindows:function(e,n,t){if(null==n||""==n)return $.Deferred().resolve().promise();var i,r=WinletJSEngine.traceToWinlet(e),a=n.split(","),l=[];for(i=0;i<a.length;i++)try{var o=a[i].trim();if("winlet"==o||"window"==o){l.push(WinletJSEngine.loadContent(r));continue}if("parent"==o){var s=WinletJSEngine.getWinlet(r.parent());null!=s&&l.push(WinletJSEngine.loadContent(s));continue}var c=!1;0==o.indexOf("!")&&(c=!0,o=o.substring(1)),0==o.indexOf("/")&&(o=o.substring(1)),o=o.indexOf("/")>=0?WinletJSEngine.getContextRoot(r)+o:WinletJSEngine.getWinletRoot(r)+o,$('div[data-winlet-url^="'+o+'"]').each(function(){l.push(WinletJSEngine.loadContent($(this),c&&!t))})}catch(g){}return $.when.apply($,l)},getActionResponseHandler:function(e,n){for(var t=null,i=null,r=2;r<arguments.length;r++)null!=arguments[r]&&("[object Array]"==Object.prototype.toString.call(arguments[r])?i=arguments[r]:t=arguments[r]);return function(r,a,l){var o=$.Deferred(),s=WinletJSEngine.getWinletResponseHeaders(r,l);if(r){r=r.replace(WinletJSEngine.reWinletHeader,"");var c=r.match(WinletJSEngine.reMetaTitle);c&&(document.title=c[1]),r=r.replace(WinletJSEngine.reMeta,"")}if(null!=s.redirect&&""!=s.redirect)return location.href=s.redirect,o.resolve().promise();if("page"==s.update)return location.reload(),o.resolve().promise();if(WinletJSEngine.clearLoading(e),null!=t&&"yes"!=s.dialog&&0==r.indexOf("WINLET_FORM_RESP:")){if(WinletJSEngine.form.validateClearAll(t),WinletJSEngine.form.applyChanges(r.substr(17),t),void 0!=t.onerror)try{t.onerror(null)}catch(g){}return o.resolve().promise()}var u;return"yes"!=s.dialog?u=WinletJSEngine.closeDialog(e):(u=$.Deferred(),u.resolve()),u.done(function(){var t=!1;if(null!=i)for(var c=0;c<i.length;c++)try{var g=i[c](r,a,l,e);if(void 0!=g&&null!=g&&!g){t=!0;break}}catch(u){alert(u)}"yes"==s.dialog?t||WinletJSEngine.openDialog(e,r,s.title):t||"yes"==s.cache||WinletJSEngine.getWindowResponseHandler(e,n)(r,a,l),WinletJSEngine.updateWindows(e,s.update).done(function(){o.resolve()}).fail(function(){o.reject()})}),o.promise()}},getErrorHandler:function(){return function(){}},isInt:function(e){return void 0!=e&&null!=e&&Number(e)===e&&e%1===0},getWinletDomainByScript:function(e){var n=location.href.match(/(http(s)?:\/\/[^\/]+)\//i),t=n?n[1]:null,i=null,r=new RegExp("^(http(s)?://[^/]+)/.*"+e,"i");return $("script").each(function(){if(null==i){var e=this.src.match(r);e&&e[1]!=t&&(i=e[1])}}),i},setup:function(e){e&&(e.analytic&&(WinletJSEngine.analytic=e.analytic),WinletJSEngine.isInt(e.left)&&(WinletJSEngine.leftSpace=e.left),WinletJSEngine.isInt(e.right)&&(WinletJSEngine.rightSpace=e.right),WinletJSEngine.isInt(e.top)&&(WinletJSEngine.topSpace=e.top),WinletJSEngine.isInt(e.bottom)&&(WinletJSEngine.bottomSpace=e.bottom),e.winletDomain&&(WinletJSEngine.winletDomain=e.winletDomain),e.contextRoot&&(WinletJSEngine.contextRoot=e.contextRoot),e.hashchange&&"function"==typeof e.hashchange&&(WinletJSEngine.hashchange=e.hashchange),e.afterload&&"function"==typeof e.afterload&&(WinletJSEngine.afterLoad=e.afterload))},winletId:1,init:function(e){$(function(){null==e&&(e={}),WinletJSEngine.setup(e),WinletJSEngine.isStatic=!0,WinletJSEngine.updateHref($("body")),$("body").append("<div id='winlet_style_temp' style='display:none'><div class='winlet_background'>1</div><div class='winlet_loading'>2</div><div class='winlet_validating'>3</div></div>"),$(function(){WinletJSEngine.ImgBg.src=$("#winlet_style_temp .winlet_background").css("background-image").replace(/^url|[\(\)"]/g,""),WinletJSEngine.ImgLoading.src=$("#winlet_style_temp .winlet_loading").css("background-image").replace(/^url|[\(\)"]/g,""),WinletJSEngine.ImgValidating.src=$("#winlet_style_temp .winlet_validating").css("background-image").replace(/^url|[\(\)"]/g,""),$("#winlet_style_temp").remove(),$("div[data-winlet-url]").each(function(){WinletJSEngine.enableForm($(this)),WinletJSEngine.updateHref($(this))});var e=window.location.toString().indexOf("#")>0;$("div[data-winlet]").each(function(){var n=null!=$(this).data("winlet-url"),t=$(this).data("winlet");0==!t.indexOf("/")&&(t="/"+t);var i=t.match(WinletJSEngine.reWinlet),r=i[1];if(0==!r.indexOf("/")&&(r="/"+r),$(this).attr("data-winlet-url",r),i.length>5&&null!=i[5]&&null!=i[5]&&$(this).attr("data-winlet-params",JSON.stringify($.deparam(i[5]))),i.length>7&&null!=i[7]&&""!=i[7]){var a,l={},o=i[7].split(",");for(a=0;a<o.length;a++){var s=o[a].match(WinletJSEngine.reWinletParam);l[s[1]]=s[2]}"yes"==l.root&&null==WinletJSEngine.hashGroupMap.root&&(WinletJSEngine.hashGroupMap[WinletJSEngine.getWinletRoot($(this))]="root"),$(this).attr("data-winlet-settings",JSON.stringify(l))}n?e&&WinletJSEngine.loadContent($(this),!1,!0):($(this).attr("data-winlet-id",++WinletJSEngine.winletId),WinletJSEngine.loadContent($(this),!1,!0))})})})}};jQuery.fn.winform=function(){var e=$.extend({},arguments[0]);return this.each(function(){if(!this.winsubmit){this.getSettings=function(){return e};var n=this,t=$(this);if(this.winletAction=t.attr("action").match(WinletJSEngine.reAction)?t.attr("action"):WinletJSEngine.getWinletUrl(e.container)+"?_a="+t.attr("action"),this.winsubmit=function(){var i=n.windeferred;if(n.windeferred=null,null==i&&(i=$.Deferred()),null!=n.onsubmit)try{if(!n.onsubmit())return i.reject(),!1}catch(r){return i.reject(),!1}var a=e.container;if(null==a||0==a.length)return i.reject(),!1;var l=e.target?e.target:a;if("multipart/form-data"==t.attr("enctype"))return n.action=n.winletAction+"&"+WinletJSEngine.mergeParam(a,{_pg:window.location.pathname,_purl:window.location.href}),i.resolve(),!0;if("POST"!=t.attr("method").toUpperCase()){var o=$.deparam(t.serialize());if(t.find(":checkbox").each(function(){void 0==o[this.name]&&(o[this.name]="")}),WinletJSEngine.setHash(a,o),"parent"==e.update){var s=WinletJSEngine.getWinlet(WinletJSEngine.traceToWinlet(a).parent());return null!=s?(WinletJSEngine.loadContent(s).done(function(){i.resolve()}).fail(function(){i.reject()}),!1):(i.reject(),!1)}return $.when(WinletJSEngine.loadContent(a),WinletJSEngine.updateWindows(a,e.update,n.nofocus)).done(function(){i.resolve()}).fail(function(){i.reject()}),!1}try{"yes"!=e.hideloading&&WinletJSEngine.showLoading(l,e.dialog)}catch(r){}for(var c=new Array,g=t.find(":input:disabled"),u=0;u<g.length;u++)""!=g[u].name&&(c[c.length]=g[u].name);var p=new Array;g=t.find(":input");for(var u=0;u<g.length;u++)""!=g[u].name&&(p[p.length]=g[u].name);return $.ajax({type:"POST",url:WinletJSEngine.getFullUrl(n.winletAction),data:WinletJSEngine.mergeParam(a,$.deparam(t.serialize()),{_x:"y",_v:e.validate,_ff:p,_fd:c,_pg:window.location.pathname,_purl:window.location.href,_c:null==l.data("winlet-src-id")?"n":"y"}),success:function(e,t,r){WinletJSEngine.getActionResponseHandler(l,!1,n,n.aftersubmit)(e,t,r).done(function(){i.resolve()}).fail(function(){i.reject()})},error:function(e,n,t){WinletJSEngine.getErrorHandler(l)(e,n,t),i.reject()
},dataType:"text"}),!1},this.ajaxValidate=function(i,r,a){void 0==r&&(r=i.name);var l=e.container;if(null==l||0==l.length)return!1;WinletJSEngine.form.validating(i);var o=a;"checkbox"==i.type?i.checked&&(o=i.value):o=i.value;var s={_vf:r,_vv:o,_vid:i.id};$.extend(s,$.deparam($(i).serialize())),t.find(":hidden").each(function(){$.extend(s,$.deparam(t.serialize()))}),$.ajax({type:"POST",url:WinletJSEngine.getFullUrl(n.winletAction),data:WinletJSEngine.mergeParam(l,s,{_x:"y",_pg:window.location.pathname,_purl:window.location.href}),success:WinletJSEngine.form.getValidateResponseHandler(i.form,r,i),dataType:"json"})},t.submit(n.winsubmit),e.focus){var i=t.find(':input[name="'+e.focus+'"]');i.select(),i.focus()}this.setAction=function(i){null!=i&&""!=i&&(t.attr("action").match(WinletJSEngine.reAction)?(i=t.attr("action").replace(WinletJSEngine.reAction,"$1?_a="+i),t.attr("action",i),n.winletAction=i):(t.attr("action",i),n.winletAction=WinletJSEngine.getWinletUrl(e.container)+"?_a="+i))},this.updateValidate=function(){if("yes"==e.validate){var n=this,t=$(n);t.find(":input").each(function(){if(null!=this.name&&""!=this.name){var e=$(this);if(!(e.closest("[data-validate='no']").length>0)){if("INPUT"==e.prop("tagName")){var n=$(this).prop("type");if("text"!=n&&"email"!=n&&"checkbox"!=n&&"radio"!=n&&"password"!=n)return}void 0!=e.attr("tips")&&e.off("blur").off("fucos").focus(function(){WinletJSEngine.form.showTip(this)}).blur(function(){WinletJSEngine.form.hideTip(this)}),e.off("change").change(function(){this.form.ajaxValidate(this)})}}})}},this.updateValidate()}})};var backToPrevPage=!1;return $(window).hashchange(function(){return backToPrevPage?(history.go(-1),void 0):(WinletJSEngine.analytic&&WinletJSEngine.analytic("hashChanged"),WinletJSEngine.detectHashChange?$("div[data-winlet]").each(function(){WinletJSEngine.loadContent($(this),!1,!1,!0)}):WinletJSEngine.detectHashChange=!0,WinletJSEngine.hashchange&&WinletJSEngine.hashchange(),void 0)}),{engine:WinletJSEngine,init:WinletJSEngine.init,setup:WinletJSEngine.setup,ensureVisible:WinletJSEngine.ensureVisible,form:WinletJSEngine.form,showLoading:WinletJSEngine.showLoading,getPositionInViewport:WinletJSEngine.getPositionInViewport,parseJson:WinletJSEngine.parseJson,getParams:function(e,n){try{if("string"==typeof e){if(0==e.indexOf("{"))return $.parseJSON(e);if(e.indexOf("=")>0)return $.deparam(e);e=WinletJSEngine.getForm(n,e)}if(null!=e&&e.is("form"))return $.deparam(e.serialize())}catch(t){}return e},back:function(){backToPrevPage=!0,history.go(-1)},_winlet:function(e){return WinletJSEngine.getWinlet(e)},_container:function(e){return WinletJSEngine.getContainer(e)},post:function(e){return win$._post(null,null,e)},_post:function(e,n,t){var i=$.Deferred(),r=null;if(null!=e&&(r=WinletJSEngine.getContainer(e),null==r))return i.reject().promise();var a=null,l=!1;"object"==typeof t&&(a=t.hash,t.hasOwnProperty("focus")&&(l=t.focus),t=t.action);var o=t.indexOf(":");if(o>0){var s=t.substr(0,o);if(t=t.substr(o+1),r=$('div[data-winlet-url^="'+WinletJSEngine.getWinletUrl(r,s)+'"]'),0==r.length)return i.reject().promise();r.length>1&&(r=$(r[0]))}if(null==r)return i.reject().promise();var c=!1;if(null!=n){var g=null;if(n instanceof jQuery?g=n:"string"==typeof n&&(g=0==n.indexOf("#")?$(n):r.is(n)?r:r.find(n)),1!=g.length)return i.reject().promise();(null==g.data("winlet-id")||""==g.data("winlet-id"))&&g.attr("data-winlet-id",++WinletJSEngine.winletId),g.removeAttr("data-winlet-url"),g.attr("data-winlet-src-id",r.data("winlet-id")),r=g,c=!0}var u={},p=[];null!=a&&WinletJSEngine.setHash(r,a);for(var d=3;d<arguments.length;d++)null!=arguments[d]&&("function"==typeof arguments[d]?p[p.length]=arguments[d]:$.extend(u,win$.getParams(arguments[d],r)));return c&&null==r.data("winlet-url")&&r.attr("data-winlet-params",JSON.stringify(u)),$.ajax({type:"POST",url:WinletJSEngine.getFullUrl(WinletJSEngine.getWinletUrl(r)),data:WinletJSEngine.mergeParam(r,u,{_x:"y",_a:t,_pg:window.location.pathname,_purl:window.location.href,_c:null==r.data("winlet-src-id")?"n":"y"}),success:function(e,n,t){WinletJSEngine.getActionResponseHandler(r,l,p)(e,n,t).done(function(){i.resolve()}).fail(function(){i.reject()})},error:function(e,n,t){WinletJSEngine.getErrorHandler(r)(e,n,t),i.reject()},dataType:"html"}),i.promise()},_include:function(e,n,t){if(!n)return $.Deferred().reject().promise();var i=null;if(n instanceof jQuery?i=n:"string"==typeof n&&(i=$("#"+n)),1!=i.length)return $.Deferred().reject().promise();if((null==i.data("winlet-id")||""==i.data("winlet-id"))&&i.attr("data-winlet-id",++WinletJSEngine.winletId),null!=e){var r=WinletJSEngine.getContainer(e);if(null==r)return $.Deferred().reject().promise();for(var a={},l=3;l<arguments.length;l++)null!=arguments[l]&&$.extend(a,win$.getParams(arguments[l],r));i.attr("data-winlet-params",JSON.stringify(a)),i.attr("data-winlet-url",WinletJSEngine.getWinletUrl(r,t))}else{for(var a={},l=3;l<arguments.length;l++)null!=arguments[l]&&$.extend(a,arguments[l]);i.attr("data-winlet-params",JSON.stringify(a)),i.attr("data-winlet-url",t)}return WinletJSEngine.loadContent(i,!1)},_ajax:function(e,n){var t=WinletJSEngine.getContainer(e);return null==t?null:($.ajax(n(t)),!1)},_get:function(e,n){var t=WinletJSEngine.getContainer(e);if(null==t)return $.Deferred().reject().promise();var i=!0,r=null,a=!0,l=!1;if(null!=n)if("object"==typeof n)for(var o in n)"reload"==o&&(i=n[o]),"update"==o&&(r=n[o]),"focus"==o&&(a=n[o]),"replaceHash"==o&&(l=n[o]);else r=n;for(var s={},c=2;c<arguments.length;c++)$.extend(s,win$.getParams(arguments[c],t));var g=!1;r&&r.indexOf("!")>=0&&(g=!0);var u=[];return WinletJSEngine.setHash(t,s,!1,l),i&&u.push(WinletJSEngine.loadContent(t,a&&!g)),r&&u.push(WinletJSEngine.updateWindows(t,r)),u.length>0?$.when.apply($,u):$.Deferred().resolve().promise()},_toggle:function(e,n){var t=WinletJSEngine.getContainer(e);if(null==t)return $.Deferred().reject().promise();for(var i={},r=2;r<arguments.length;r++)$.extend(i,win$.getParams(arguments[r],t));return WinletJSEngine.setHash(t,i,!0),$.when(WinletJSEngine.loadContent(t),WinletJSEngine.updateWindows(t,n))},_url:function(e,n){var t=WinletJSEngine.getContainer(e);if(null==t)return!1;for(var i={},r=2;r<arguments.length;r++)$.extend(i,win$.getParams(arguments[r],t));var a=WinletJSEngine.getWinletUrl(t);return a+=a.indexOf("?")>0?"&":"?",a+WinletJSEngine.mergeParam(t,i,{_x:"y",_a:n,_pg:window.location.pathname,_purl:window.location.href})},_submit:function(e,n,t){var i=$.Deferred(),r=WinletJSEngine.getContainer(e);if(null==r)return i.reject().promise();var a=null;if("string"==typeof n)a=WinletJSEngine.getForm(r,n);else try{a=$(n).closest("form")}catch(l){}if(null==a||1!=a.length||!a[0].setAction)return i.reject().promise();a[0].setAction(t);for(var o=!1,s={},c=3;c<arguments.length;c++)null!=arguments[c]&&(3!=c||"boolean"!=typeof arguments[c]?$.extend(s,win$.getParams(arguments[c],r)):o=arguments[c]);for(var g in s)a.find("input[name="+g+"]").attr("value",s[g]);return a[0].windeferred=i,a[0].nofocus=o,a.submit(),i.promise()},_aftersubmit:function(e,n){var t=WinletJSEngine.getContainer(e);if(null==t)return!1;var i=WinletJSEngine.getForm(t,n);if(1!=i.length)return!1;for(var r=[],a=2;a<arguments.length;a++)null!=arguments[a]&&"function"==typeof arguments[a]&&(r[r.length]=arguments[a]);return i[0].aftersubmit=r,!1},_find:function(e,n){var t=WinletJSEngine.getContainer(e);if(null==t)return $();if(!n)return t;var i=t.find(n);if(0!=i.length)return i;var r=WinletJSEngine.getDialog(WinletJSEngine.traceToWinlet(t),!1);return null==r?$():r.find(n)},_wait:function(e,n,t){var i=WinletJSEngine.getContainer(e);if(null==i)return!1;var r=(new Date).getTime(),a=$.Deferred();return function(){void 0==i.find(n)?null!=t&&(new Date).getTime()-r>t?a.reject():window.setTimeout(arguments.callee,300):a.resolve()}(),a.promise()}}}();
win$.engine.getDialog=function(n,e){var i=win$.engine.traceToWinlet(n);if(null==i||1!=i.length)return null;if(null==i[0].dlg){if(!e)return null;i[0].dlg=$('<div class="modal fade" data-winlet-dialog="yes" tabindex="-1" role="dialog" aria-hidden="true"><div class="modal-dialog"><div class="modal-content"><div class="modal-header"><button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button><h4 class="modal-title">&nbsp;</h4></div><div class="modal-body">Body</div><div class="modal-footer">&nbsp;</div></div></div></div>'),$(document.body).append(i[0].dlg),i[0].dlg.on("show.bs.modal",function(){$(this).css("display","block");var n=$(this).find(".modal-dialog"),e=($(window).height()-n.height())/3;n.css("margin-top",e)})}return i[0].dlg},win$.engine.closeDialog=function(n){var e=$.Deferred(),i=win$.engine.getDialog(n,!1);if(null==i)return e.resolve(),e;try{i.hasClass("in")?i.off("hidden.bs.modal").on("hidden.bs.modal",function(){e.resolve()}).modal("hide"):e.resolve()}catch(t){e.resolve()}return i.find("div.modal-body").empty(),e},win$.engine.openDialog=function(n,e,i){var t=win$.engine.getDialog(n,!0),a=t.find("div.modal-body"),l=$.trim(win$.engine.procStyle(win$.engine.procWinFunc(e.replace(win$.engine.reScriptAll,"").replace(win$.engine.reDialogSetting,""),n)));if(""==l)return win$.engine.closeDialog(n),void 0;a.empty().append('<div data-winlet-src-id="'+n.data("winlet-id")+'">'+l+"<div>");var o=win$.engine.reDialogSetting.exec(e);if(null!=o){if(o=JSON.parse(win$.engine.procWinFunc(o[1],n)),t.find("h4.modal-title").empty().append(o.title),o.width&&""!=o.width)t.find(".modal-dialog").css("width",o.width);else if(o.maxwidth&&""!=o.maxwidth)try{var d=parseInt(o.maxwidth),r=0,s=win$.engine.getViewport().width;o.padding&&""!=o.padding&&(r=parseInt(o.padding)),s>d+2*r?t.find(".modal-dialog").css("width",Math.round(d/s*100)+"%"):t.find(".modal-dialog").css("width","")}catch(u){console.log(u)}else t.find(".modal-dialog").css("width","");for(var g=t.find("div.modal-footer").empty(),c=0;c<o.buttons.length;c++){var f='<button type="button"';for(var m in o.buttons[c])"label"!=m&&(f=f+" "+m+'="'+o.buttons[c][m]+'"');f=f+">"+o.buttons[c].label+"</button>",g.append(f)}}else null!=i&&t.find("h4.modal-title").empty().append(i);$(function(){var i=null;a.find("form[data-winlet-form]").each(function(){var e=$(this),a=win$.engine.getContainer(e);e.winform({focus:e.attr("data-winlet-focus"),update:e.attr("data-winlet-update"),validate:e.attr("data-winlet-validate"),hideloading:e.attr("data-winlet-hideloading"),container:null==a?n:a,dialog:t}),e.attr("data-winlet-focus")&&(i=e.find('input[name="'+e.attr("data-winlet-focus")+'"]'))}),win$.engine.procScript(e,n),win$.engine.invokeAfterLoad(a),i&&t.off("shown.bs.modal").on("shown.bs.modal",function(){i.select(),i.focus()}),t.modal("show")})},win$.engine.form.validateClearAll=function(n){n instanceof jQuery||(n=$(n)),n.find("span.validate_result").each(function(){var n=$(this);n.html("");var e=n.closest("div.form-group, .winlet-input-group");e.length>0&&$(e[0]).removeClass("has-error").removeClass("has-success")})},win$.engine.form.validateClear=function(){for(var n=0;n<arguments.length;n++){var e=win$.engine.form.getInputResult(arguments[n]);if(null!=e){e.html("");var i=e.closest("div.form-group, .winlet-input-group");i.length>0&&$(i[0]).removeClass("has-error").removeClass("has-success")}}},win$.engine.form.validateSuccess=function(n){var e=win$.engine.form.getInputResult(n);if(null!=e){e.html("");var i=e.closest("div.form-group, .winlet-input-group");i.length>0&&$(i[0]).removeClass("has-error").addClass("has-success")}},win$.engine.form.validateError=function(){var n=win$.engine.form.validateError;return function(e,i){n(e,i);var t=win$.engine.form.getInputResult(e);if(null!=t){var a=t.closest("div.form-group, .winlet-input-group");a.length>0&&$(a[0]).removeClass("has-success").addClass("has-error")}return!0}}();
var WinletDrag={R_DRAG_ELEMENT_TYPE:new RegExp("winletdrag_(\\S+)"),m_arrAreas:null,m_arrAreaRects:null,m_arrConts:null,m_arrContRects:null,m_elmMove:null,m_elmDropIndicate:null,m_elmArea:null,m_elmContent:null,m_elmContentRect:null,m_offsetMove:null,m_defaultConfig:{indicatorClass:"winlet_drop",isVertical:!0,moveAfterDrag:!0,showDropLocation:!0,dragStart:function(){},dragEnd:function(){},dragged:function(){}},m_configs:{},config:function(e,t){WinletDrag.m_configs[e]=$.extend({},WinletDrag.m_defaultConfig,t)},getConfig:function(){var e=WinletDrag.m_elmContent.drag_data_group;return null==WinletDrag.m_configs[e]&&WinletDrag.config(e,{}),WinletDrag.m_configs[e]},initArrObjects:function(e){if(null!=e){var t=e.className.match(WinletDrag.R_DRAG_ELEMENT_TYPE);null!=t&&(e.drag_element_type=t[1],e.drag_data_group=$(e).attr("data-drag-group"),"area"==e.drag_element_type&&(WinletDrag.m_arrAreas[WinletDrag.m_arrAreas.length]=e,WinletDrag.m_arrAreaRects[WinletDrag.m_arrAreaRects.length]=WinletDrag.getRect(e),e.container=WinletDrag.getElement(e,"cont")),"cont"==e.drag_element_type&&(WinletDrag.m_arrConts[WinletDrag.m_arrConts.length]=e,WinletDrag.m_arrContRects[WinletDrag.m_arrContRects.length]=WinletDrag.getRect(e)));var n;for(n=0;n<e.children.length;n++)WinletDrag.initArrObjects(e.children[n])}},initAreasAndContents:function(){WinletDrag.m_arrAreas=new Array,WinletDrag.m_arrAreaRects=new Array,WinletDrag.m_arrConts=new Array,WinletDrag.m_arrContRects=new Array,WinletDrag.initArrObjects(window.document.body)},getRect:function(e){var t=$(e),n=t.offset();return n.width=t.outerWidth(),n.height=t.outerHeight(),n.bottom=n.top+n.height,n.right=n.left+n.width,n},getPosiRect:function(e){var t=$(e),n=t.position();return n.width=t.outerWidth(),n.height=t.outerHeight(),n.bottom=n.top+n.height,n.right=n.left+n.width,n},clearSelection:function(){try{window.getSelection?window.getSelection().empty?window.getSelection().empty():window.getSelection().removeAllRanges&&window.getSelection().removeAllRanges():document.selection&&document.selection.empty()}catch(e){}},newRect:function(e,t,n,r){return{top:e,left:t,bottom:n,right:r,width:r-t,height:n-e}},getElement:function(e,t,n){if(!t)return null;for(;e;){if(e.drag_element_type==t&&(void 0==n||null==n||e.drag_data_group==n))return e;e=e.parentNode}return null},findArea:function(e,t,n){var r;for(r=WinletDrag.m_arrAreaRects.length-1;r>=0;r--)if(e>=WinletDrag.m_arrAreaRects[r].left&&e<=WinletDrag.m_arrAreaRects[r].right&&t>=WinletDrag.m_arrAreaRects[r].top&&t<=WinletDrag.m_arrAreaRects[r].bottom&&(void 0==n||null==n||WinletDrag.m_arrAreas[r].drag_data_group==n))return WinletDrag.m_arrAreas[r];return null},findCont:function(e,t,n){var r;for(r=WinletDrag.m_arrContRects.length-1;r>=0;r--)if(e>=WinletDrag.m_arrContRects[r].left&&e<=WinletDrag.m_arrContRects[r].right&&t>=WinletDrag.m_arrContRects[r].top&&t<=WinletDrag.m_arrContRects[r].bottom&&(void 0==n||null==n||WinletDrag.m_arrConts[r].drag_data_group==n))return r;return null},doMouseDown:function(e){if(1==e.which&&(WinletDrag.initAreasAndContents(),WinletDrag.m_elmContent=WinletDrag.getElement(e.target,"cont"),null!=WinletDrag.m_elmContent)){WinletDrag.m_elmArea=WinletDrag.getElement(WinletDrag.m_elmContent,"area",WinletDrag.m_elmContent.drag_data_group),WinletDrag.getConfig().dragStart(WinletDrag.m_elmContent),WinletDrag.m_elmContentRect=WinletDrag.getRect(WinletDrag.m_elmContent);var t=WinletDrag.getPosiRect(WinletDrag.m_elmContent);WinletDrag.m_elmMove=$("<div></div>"),WinletDrag.m_elmMove.append($(WinletDrag.m_elmContent).clone()),WinletDrag.m_elmMove.addClass("winlet_drag"),WinletDrag.m_elmMove.css("left",t.left),WinletDrag.m_elmMove.css("top",t.top),WinletDrag.m_elmMove.css("width",t.width),WinletDrag.m_offsetMove=new Object,WinletDrag.m_offsetMove.x=t.left-e.pageX,WinletDrag.m_offsetMove.y=t.top-e.pageY,$(WinletDrag.m_elmContent.parentNode).append(WinletDrag.m_elmMove),$(WinletDrag.m_elmContent).css("opacity",.5),WinletDrag.m_elmMove.css("opacity",.5),WinletDrag.clearSelection()}},findDropLocation:function(e,t){var n=new Object;return n.area=WinletDrag.findArea(e,t,WinletDrag.m_elmContent.drag_data_group),null==n.area?null:(contIdx=WinletDrag.findCont(e,t,WinletDrag.m_elmContent.drag_data_group),null!=contIdx&&WinletDrag.m_arrConts[contIdx]!=n.area.container&&(n.content=WinletDrag.m_arrConts[contIdx],n.before=WinletDrag.getConfig().isVertical?t<WinletDrag.m_arrContRects[contIdx].top+WinletDrag.m_arrContRects[contIdx].height/2:e<WinletDrag.m_arrContRects[contIdx].left+WinletDrag.m_arrContRects[contIdx].width/2),n)},showDropPoint:function(e,t){null!=WinletDrag.m_elmDropIndicate&&WinletDrag.m_elmDropIndicate.remove();var n=WinletDrag.findDropLocation(e,t);null!=n&&n.content!=WinletDrag.m_elmContent&&(null!=n.content||n.area!=WinletDrag.m_elmArea)&&(WinletDrag.m_elmDropIndicate=$("<"+WinletDrag.m_elmContent.nodeName+"></"+WinletDrag.m_elmContent.nodeName+">"),WinletDrag.m_elmDropIndicate.addClass(WinletDrag.getConfig().indicatorClass),null!=n.content?n.before?$(n.content).before(WinletDrag.m_elmDropIndicate):$(n.content).after(WinletDrag.m_elmDropIndicate):$(n.area).append(WinletDrag.m_elmDropIndicate))},doMouseMove:function(e){null!=WinletDrag.m_elmMove&&null!=WinletDrag.m_offsetMove&&(WinletDrag.clearSelection(),WinletDrag.m_elmMove.css("left",e.pageX+WinletDrag.m_offsetMove.x),WinletDrag.m_elmMove.css("top",e.pageY+WinletDrag.m_offsetMove.y),WinletDrag.getConfig().showDropLocation&&WinletDrag.showDropPoint(e.pageX,e.pageY))},doMouseUp:function(e){null!=WinletDrag.m_elmDropIndicate&&WinletDrag.m_elmDropIndicate.remove();var t=$.Deferred();if(null!=WinletDrag.m_elmContent){$(WinletDrag.m_elmContent).css("opacity",1);var n=WinletDrag.findDropLocation(e.pageX,e.pageY);if(null==n||n.content==WinletDrag.m_elmContent||null==n.content&&n.area==WinletDrag.m_elmArea)WinletDrag.getConfig().dragEnd(WinletDrag.m_elmContent,n);else{WinletDrag.getConfig().moveAfterDrag&&(null==n.content?$(n.area).append(WinletDrag.m_elmContent):n.before?$(n.content).before(WinletDrag.m_elmContent):$(n.content).after(WinletDrag.m_elmContent));var r=WinletDrag.m_elmContent;t.done(function(){$(n.area).trigger("dragged",[r,n])}),WinletDrag.getConfig().dragged(WinletDrag.m_elmContent,n)}WinletDrag.m_elmContent=null}null!=WinletDrag.m_elmMove&&(WinletDrag.m_elmMove.remove(),WinletDrag.m_elmMove=null),t.resolve()},documentEventBounded:!1,init:function(e){var t=e.find(".winletdrag_drag");t.css("cursor","move"),t.off("mousedown").on("mousedown",WinletDrag.doMouseDown),WinletDrag.documentEventBounded||($(document).mousemove(WinletDrag.doMouseMove),$(document).mouseup(WinletDrag.doMouseUp),WinletDrag.documentEventBounded=!0)}};$(document).on("WinletWindowLoaded",function(e){WinletDrag.init($(e.target))}),function(e){e.fn.WinletMenu=function(t,n,r,l){e(this).css({cursor:"context-menu"});var o=e(n);if(0!=o.length){o.css({display:"none"});var a=null;e(this).on(t,function(t){o.data("menusrc",e(this));var n;return null==r?n={top:t.pageY,left:t.pageX}:(null==l&&(l=0),rect=WinletDrag.getRect(t.target),n="bottomleft"==r?{top:rect.bottom+l,left:rect.left}:"topright"==r?{top:rect.top,left:rect.right+l}:"bottomright"==r?{top:rect.bottom+l,left:rect.right+l}:{top:rect.top,left:rect.left}),null==a&&(o.css({position:"absolute",display:"block",top:0,left:0}),a=o.offset()),o.css({display:"block",top:n.top-a.top,left:n.left-a.left}),e("body").off("mouseup").on("mouseup",function(n){return n.target==t.target&&2==n.button?!0:(o.css({display:"none"}),e("body").off("mousedown"),!0)}),!1})}},e.fn.WinletContextMenu=function(t,n,r){e(this).WinletMenu("contextmenu",t,n,r)},e.fn.WinletClickMenu=function(t,n,r){e(this).WinletMenu("click",t,n,r)}}(jQuery);